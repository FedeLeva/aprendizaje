<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Guia practica - 2022 | Guias</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Descripcion">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/aprendizaje/assets/css/0.styles.5e6ce45c.css" as="style"><link rel="preload" href="/aprendizaje/assets/js/app.11b5cd3b.js" as="script"><link rel="preload" href="/aprendizaje/assets/js/2.c431ec36.js" as="script"><link rel="preload" href="/aprendizaje/assets/js/43.860d12d1.js" as="script"><link rel="prefetch" href="/aprendizaje/assets/js/10.ebb9a2d4.js"><link rel="prefetch" href="/aprendizaje/assets/js/11.7f6678e6.js"><link rel="prefetch" href="/aprendizaje/assets/js/12.94178c81.js"><link rel="prefetch" href="/aprendizaje/assets/js/13.7fd153b2.js"><link rel="prefetch" href="/aprendizaje/assets/js/14.ac7318bb.js"><link rel="prefetch" href="/aprendizaje/assets/js/15.0dc76b53.js"><link rel="prefetch" href="/aprendizaje/assets/js/16.e127c599.js"><link rel="prefetch" href="/aprendizaje/assets/js/17.54b0f17c.js"><link rel="prefetch" href="/aprendizaje/assets/js/18.30deebe2.js"><link rel="prefetch" href="/aprendizaje/assets/js/19.166099ae.js"><link rel="prefetch" href="/aprendizaje/assets/js/20.980fa4da.js"><link rel="prefetch" href="/aprendizaje/assets/js/21.7018fded.js"><link rel="prefetch" href="/aprendizaje/assets/js/22.e33a4cdc.js"><link rel="prefetch" href="/aprendizaje/assets/js/23.e516d08e.js"><link rel="prefetch" href="/aprendizaje/assets/js/24.edd49cff.js"><link rel="prefetch" href="/aprendizaje/assets/js/25.26964830.js"><link rel="prefetch" href="/aprendizaje/assets/js/26.466ededc.js"><link rel="prefetch" href="/aprendizaje/assets/js/27.d8bab02d.js"><link rel="prefetch" href="/aprendizaje/assets/js/28.9898f043.js"><link rel="prefetch" href="/aprendizaje/assets/js/29.f3457f72.js"><link rel="prefetch" href="/aprendizaje/assets/js/3.48568f76.js"><link rel="prefetch" href="/aprendizaje/assets/js/30.162ed83d.js"><link rel="prefetch" href="/aprendizaje/assets/js/31.914b9374.js"><link rel="prefetch" href="/aprendizaje/assets/js/32.7c8797ab.js"><link rel="prefetch" href="/aprendizaje/assets/js/33.aa552d3e.js"><link rel="prefetch" href="/aprendizaje/assets/js/34.961d4adc.js"><link rel="prefetch" href="/aprendizaje/assets/js/35.183d4b13.js"><link rel="prefetch" href="/aprendizaje/assets/js/36.b2c46711.js"><link rel="prefetch" href="/aprendizaje/assets/js/37.4486e40c.js"><link rel="prefetch" href="/aprendizaje/assets/js/38.d5c9d1ca.js"><link rel="prefetch" href="/aprendizaje/assets/js/39.2b76f93e.js"><link rel="prefetch" href="/aprendizaje/assets/js/4.7b66cd35.js"><link rel="prefetch" href="/aprendizaje/assets/js/40.13e06b26.js"><link rel="prefetch" href="/aprendizaje/assets/js/41.d1f1644f.js"><link rel="prefetch" href="/aprendizaje/assets/js/42.c441fa36.js"><link rel="prefetch" href="/aprendizaje/assets/js/44.f6ff59c9.js"><link rel="prefetch" href="/aprendizaje/assets/js/45.9c247c80.js"><link rel="prefetch" href="/aprendizaje/assets/js/46.58ddbf44.js"><link rel="prefetch" href="/aprendizaje/assets/js/47.4eb8854e.js"><link rel="prefetch" href="/aprendizaje/assets/js/48.b339bd74.js"><link rel="prefetch" href="/aprendizaje/assets/js/49.f61f18e2.js"><link rel="prefetch" href="/aprendizaje/assets/js/5.a396fb32.js"><link rel="prefetch" href="/aprendizaje/assets/js/6.27888615.js"><link rel="prefetch" href="/aprendizaje/assets/js/7.06129e92.js"><link rel="prefetch" href="/aprendizaje/assets/js/8.b72daec4.js"><link rel="prefetch" href="/aprendizaje/assets/js/9.7e901376.js">
    <link rel="stylesheet" href="/aprendizaje/assets/css/0.styles.5e6ce45c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/aprendizaje/" class="home-link router-link-active"><!----> <span class="site-name">Guias</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/aprendizaje/" class="nav-link">
  Inicio
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/aprendizaje/" class="nav-link">
  Inicio
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/aprendizaje/Node/" aria-current="page" class="sidebar-link">Lo Basico de Node</a></li><li><a href="/aprendizaje/Node/motor.html" class="sidebar-link">Motores de plantillas/vistas</a></li><li><a href="/aprendizaje/Node/router.html" class="sidebar-link">Router</a></li><li><a href="/aprendizaje/Node/mongo.html" class="sidebar-link">MongoDB</a></li><li><a href="/aprendizaje/Node/token.html" class="sidebar-link">Token y Practica API REST</a></li><li><a href="/aprendizaje/Node/Guia.html" aria-current="page" class="active sidebar-link">Guia practica - 2022</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#carpeta-public" class="sidebar-link">carpeta public</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#motor-de-plantilla" class="sidebar-link">Motor de plantilla</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#configuracion" class="sidebar-link">Configuracion</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#main-hbs" class="sidebar-link">main.hbs</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#css-js-etc" class="sidebar-link">CSS , JS , etc</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#each" class="sidebar-link">Each</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#configurar-partials" class="sidebar-link">Configurar Partials</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#router" class="sidebar-link">Router</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#configuracion-mongodb" class="sidebar-link">Configuracion mongoDB</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#modelo-esquema" class="sidebar-link">Modelo/Esquema</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#controladores-mvc" class="sidebar-link">Controladores (MVC)</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#instanciar-un-modelo" class="sidebar-link">Instanciar un modelo</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#guardar-en-la-bd" class="sidebar-link">Guardar en la BD</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#leer-datos" class="sidebar-link">Leer datos</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#eliminar-datos" class="sidebar-link">Eliminar datos</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#validacion-con-middlewares" class="sidebar-link">Validacion con middlewares</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#editar-en-mongodb" class="sidebar-link">Editar en MongoDB</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#clipboard" class="sidebar-link">clipboard</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#redireccionamiento" class="sidebar-link">Redireccionamiento</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/Guia.html#pasar-a-otro" class="sidebar-link">Pasar a otro</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="guia-practica-2022"><a href="#guia-practica-2022" class="header-anchor">#</a> Guia practica - 2022</h1> <p>Iniciamos el proyecto</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>npm init <span class="token operator">-</span>y
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>No utilizar espacios , tildes y no colocar nombres reservados (nombre de  package/modulos)</p></div> <p>package.json:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
 <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;practica&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nodemon index.js&quot;</span><span class="token punctuation">,</span>
   <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node index.js&quot;</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token property">&quot;nodemon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.0.15&quot;</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token property">&quot;express&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.17.3&quot;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">modelo MVC</p> <p>Vamos a trabajar con el modelo vista controlador</p> <p>Los controladores , las vistas y los modelos los vamos a separar</p></div> <h2 id="carpeta-public"><a href="#carpeta-public" class="header-anchor">#</a> carpeta public</h2> <ul><li><p>Cuando se trabaja desde el backend todo esta protegido , no se puede acceder desde el navegador.</p></li> <li><p>Pero podemos crear la carpeta public cuyos archivos si son p칰blicos, se pueden acceder desde el navegador (ingresando la url)</p></li></ul> <p>Creamos la carpeta public y dentro un archivo index.html</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>index.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>TODAVIA NO SE PUEDE ACCEDER A index.html desde el navegador porque no esta configurada la carpeta public.</p> <p>Para hacer que todos los archivos de la carpeta public puedan ser accedido desde el navegador usamos el middleware.</p></div> <div class="custom-block tip"><p class="custom-block-title">middleware</p> <ul><li>Middleware = Se ejecuta antes de la respuesta del servidor.</li> <li>use = Middleware.</li></ul></div> <p>index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Usamos el middleware de express</span>
<span class="token comment">// Asignamos la carpeta publica</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// req = requirimiento(lo que manda el usuario) res = respuesta</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;estas solicitando la ruta raiz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">5000</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;server andando 游댠 http://localhost:5000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="motor-de-plantilla"><a href="#motor-de-plantilla" class="header-anchor">#</a> Motor de plantilla</h2> <ul><li>Para no repetir todo el c칩digo HTML (por ejemplo, todos los archivos HTML deben tener el mismo footer o el mismo men칰) , surgieron los motores de plantilla.</li></ul> <p>Instalamos un motor de plantilla  (existen muchos)</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>npm i express express<span class="token operator">-</span>handlebars
</code></pre></div><ul><li>Se parece a vue pero es mucho mas viejo.</li> <li>Tiene limitantes este motor de plantilla, que soluciona react , vue , etc.</li></ul> <p>Creamos una carpeta views y dentro  la carpeta layouts.</p> <ul><li>views
<ul><li>layouts</li></ul></li></ul> <p>Lo archivos que contiene layouts son los que podemos repetir en todas las p치ginas web (men칰, footer , etc).</p> <p>dentro de la carpeta layouts creamos un archivo main.hbs</p> <p>views/layouts/main.hbs:</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token punctuation">!</span><span class="token variable">DOCTYPE</span> <span class="token variable">html</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">html</span> <span class="token variable">lang</span><span class="token punctuation">=</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">charset</span><span class="token punctuation">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">http-equiv</span><span class="token punctuation">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;IE=edge&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">name</span><span class="token punctuation">=</span><span class="token string">&quot;viewport&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">title</span><span class="token punctuation">&gt;</span><span class="token variable">Desde</span> <span class="token variable">HBS</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">title</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span><span class="token variable">Plantilla</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">html</span><span class="token punctuation">&gt;</span>

</code></pre></div><p>y creamos el archivo home.hbs en la carpeta views</p> <p>views/home.hbs:</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token punctuation">!</span><span class="token variable">DOCTYPE</span> <span class="token variable">html</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">html</span> <span class="token variable">lang</span><span class="token punctuation">=</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">charset</span><span class="token punctuation">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">http-equiv</span><span class="token punctuation">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;IE=edge&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">name</span><span class="token punctuation">=</span><span class="token string">&quot;viewport&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">title</span><span class="token punctuation">&gt;</span><span class="token variable">Document</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">title</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span><span class="token variable">Hola</span> <span class="token variable">desde</span> <span class="token variable">Home</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">html</span><span class="token punctuation">&gt;</span>

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Nodemon no actualiza el servidor si hay alg칰n cambio dentro de alg칰n archivo hbs.</p> <p>Para solucionar esto creamos en la ruta raiz el archivo nodemon.json que va a contener:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;ext&quot;</span><span class="token operator">:</span> <span class="token string">&quot;js,json,hbs&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>En pocas palabras , estamos configurando Nodemon para que detecte cambios en archivos .js , .json y .hbs.</p></div> <h2 id="configuracion"><a href="#configuracion" class="header-anchor">#</a> Configuracion</h2> <p>Ahora vamos a configurar el motor de plantilla en el archivo index.js</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// const create = recibe las configuraciones de express-handlebards</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express-handlebars&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Le decimos que la extension de los archivos de views es  .hbs</span>
<span class="token keyword">const</span> hbs <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    extname<span class="token operator">:</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Configuramos express </span>
<span class="token comment">// Le decimos que motor de plantilla usar</span>
<span class="token comment">// Especificamos el motor de plantilla</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span> hbs<span class="token punctuation">.</span>engine<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Especificamos la extension del motor del plantilla (.hbs)</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;view engine&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Especificamos la carpeta en donde van a estar los archivos .hbs</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;views&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./views&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Como respuesta renderiza(convierte en HTML) el archivo home.hbs</span>
    <span class="token comment">// Se puede quitar el .hbs</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">5000</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;server andando 游댠 http://localhost:5000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li>Como la carpeta public la maneja el middleware y este se ejecuta antes de que el servidor reciba las peticiones get/post/etc , lo que contiene la carpeta public se llama primero.</li> <li>La l칤nea app.use(express.static(__dirname + &quot;/public&quot;)); debe ir debajo de todo para evitar conflictos entre las rutas y archivos publicos</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>

<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// const create = recibe las configuraciones de express-handlebards</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express-handlebars&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Le decimos que la extension de los archivos de views es  .hbs</span>
<span class="token keyword">const</span> hbs <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    extname<span class="token operator">:</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Configuramos express </span>
<span class="token comment">// Le decimos que motor de plantilla usar</span>
<span class="token comment">// Especificamos el motor de plantilla</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span> hbs<span class="token punctuation">.</span>engine<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Especificamos la extension del motor del plantilla (.hbs)</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;view engine&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Especificamos la carpeta en donde van a estar los archivos .hbs</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;views&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./views&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Como respuesta renderiza(convierte en HTML) el archivo home.hbs</span>
    <span class="token comment">// Se puede quitar el .hbs</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">5000</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;server andando 游댠 http://localhost:5000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div></div> <h2 id="main-hbs"><a href="#main-hbs" class="header-anchor">#</a> main.hbs</h2> <p>Como se ve, se muestra la plantilla (el archivo main.hbs) y no el home.hbs.</p> <p>Esto es porque , Se lee de forma autom치tica el main.hbs</p> <p>La plantilla main.hbs se utiliza en todas las paginas</p> <p>Por lo tanto podemos hacer que lo que est치 en el home.hbs  aparezca adentro del body del main.hbs</p> <p>home.hbs:</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code> <span class="token punctuation">&lt;</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span><span class="token variable">Hola</span> <span class="token variable">desde</span> <span class="token variable">Home</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span>
</code></pre></div><p>main.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token punctuation">!</span><span class="token variable">DOCTYPE</span> <span class="token variable">html</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">html</span> <span class="token variable">lang</span><span class="token punctuation">=</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">charset</span><span class="token punctuation">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">http-equiv</span><span class="token punctuation">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;IE=edge&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">name</span><span class="token punctuation">=</span><span class="token string">&quot;viewport&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">title</span><span class="token punctuation">&gt;</span><span class="token variable">Desde</span> <span class="token variable">HBS</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">title</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">body</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">html</span><span class="token punctuation">&gt;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">variable body</p> <p>Usamos la variable body  que tiene hbs , que su valor es todo lo que contiene  home.hbs</p></div> <p>Creamos un archivo login.hbs en views
views/login.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span><span class="token variable">Login</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span>
</code></pre></div><p>index.js:</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// const create = recibe las configuraciones de express-handlebards</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express-handlebars&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Le decimos que la extension de los archivos de views es  .hbs</span>
<span class="token keyword">const</span> hbs <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    extname<span class="token operator">:</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Configuramos express </span>
<span class="token comment">// Le decimos que motor de plantilla usar</span>
<span class="token comment">// Especificamos el motor de plantilla</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span> hbs<span class="token punctuation">.</span>engine<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Especificamos la extension del motor del plantilla (.hbs)</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;view engine&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Especificamos la carpeta en donde van a estar los archivos .hbs</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;views&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./views&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Como respuesta renderiza(convierte en HTML) el archivo home.hbs</span>
    <span class="token comment">// Se puede quitar el .hbs</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Como respuesta renderiza(convierte en HTML) el archivo home.hbs</span>
    <span class="token comment">// Se puede quitar el .hbs</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">5000</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;server andando 游댠 http://localhost:5000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">variable body</p> <p>Al entrar a http://localhost:5000/login la variable body de main.hbs contiene  todo el contenido de login.hbs</p></div> <h2 id="css-js-etc"><a href="#css-js-etc" class="header-anchor">#</a> CSS , JS , etc</h2> <p>A침adimos boostrap a las dos rutas</p> <p>main.hbs:</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token punctuation">!</span><span class="token variable">DOCTYPE</span> <span class="token variable">html</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">html</span> <span class="token variable">lang</span><span class="token punctuation">=</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">charset</span><span class="token punctuation">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">http-equiv</span><span class="token punctuation">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;IE=edge&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">name</span><span class="token punctuation">=</span><span class="token string">&quot;viewport&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">title</span><span class="token punctuation">&gt;</span><span class="token variable">Desde</span> <span class="token variable">HBS</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">title</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">link</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css&quot;</span> <span class="token variable">rel</span><span class="token punctuation">=</span><span class="token string">&quot;stylesheet&quot;</span> <span class="token variable">integrity</span><span class="token punctuation">=</span><span class="token string">&quot;sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3&quot;</span> <span class="token variable">crossorigin</span><span class="token punctuation">=</span><span class="token string">&quot;anonymous&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;container mt-5&quot;</span><span class="token punctuation">&gt;</span>
 <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">body</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
     
      <span class="token punctuation">&lt;</span><span class="token variable">script</span> <span class="token variable">src</span><span class="token punctuation">=</span><span class="token string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js&quot;</span> <span class="token variable">integrity</span><span class="token punctuation">=</span><span class="token string">&quot;sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p&quot;</span> <span class="token variable">crossorigin</span><span class="token punctuation">=</span><span class="token string">&quot;anonymous&quot;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">script</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">html</span><span class="token punctuation">&gt;</span>

</code></pre></div><ul><li>Todas las paginas que tengamos, van a tener Bootstrap</li> <li>Y todo el contenido de XXX.hbs va a estar en un div que contiene clases de Bootstrap</li></ul> <div class="custom-block tip"><p class="custom-block-title">carpeta public</p> <ul><li>carpeta public = trabajar con el frontend = se muestra en el navegador</li> <li>el resto de carpetas(incluida la raiz) = trabajar con el backend</li></ul></div> <p>Invocar un script que esta en la carpeta public:</p> <p>public/js/script.js</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hola&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>main.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token punctuation">!</span><span class="token variable">DOCTYPE</span> <span class="token variable">html</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">html</span> <span class="token variable">lang</span><span class="token punctuation">=</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">charset</span><span class="token punctuation">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">http-equiv</span><span class="token punctuation">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;IE=edge&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">name</span><span class="token punctuation">=</span><span class="token string">&quot;viewport&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">title</span><span class="token punctuation">&gt;</span><span class="token variable">Desde</span> <span class="token variable">HBS</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">title</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">link</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css&quot;</span> <span class="token variable">rel</span><span class="token punctuation">=</span><span class="token string">&quot;stylesheet&quot;</span> <span class="token variable">integrity</span><span class="token punctuation">=</span><span class="token string">&quot;sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3&quot;</span> <span class="token variable">crossorigin</span><span class="token punctuation">=</span><span class="token string">&quot;anonymous&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;container mt-5&quot;</span><span class="token punctuation">&gt;</span>
 <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">body</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
     
      <span class="token punctuation">&lt;</span><span class="token variable">script</span> <span class="token variable">src</span><span class="token punctuation">=</span><span class="token string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js&quot;</span> <span class="token variable">integrity</span><span class="token punctuation">=</span><span class="token string">&quot;sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p&quot;</span> <span class="token variable">crossorigin</span><span class="token punctuation">=</span><span class="token string">&quot;anonymous&quot;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">script</span><span class="token punctuation">&gt;</span>
      <span class="token punctuation">&lt;</span><span class="token variable">script</span> <span class="token variable">src</span><span class="token punctuation">=</span><span class="token string">&quot;/js/script.js&quot;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">script</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>

</code></pre></div><h2 id="each"><a href="#each" class="header-anchor">#</a> Each</h2> <ul><li>Vamos a usar los Block Helpers</li> <li><a href="https://handlebarsjs.com/guide/block-helpers.html#simple-iterators" target="_blank" rel="noopener noreferrer">Link<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Each  == forEach</li></ul> <p>home.hbs:</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span><span class="token variable">Hola</span> <span class="token variable">desde</span> <span class="token variable">Home</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">#</span><span class="token variable">each</span> <span class="token variable">urls</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token punctuation">&lt;</span><span class="token variable">article</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card mb-2&quot;</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card-body&quot;</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">origen</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">shortUrl</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-danger&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Eliminar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-warning&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Editar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-info&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">copiar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">article</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">/</span><span class="token variable">each</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">carpeta Components</p> <p>Vamos a crear la carpeta components dentro de views que son pedazitos de c칩digo que se van a repetir (el c칩digo se suele repetir por medio de ciclos (each, etc))</p></div> <p>Y dentro de la carpeta creamos el archivo Card.hbs</p> <p>views/components/Card.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token variable">article</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card mb-2&quot;</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card-body&quot;</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">origen</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">shortUrl</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-danger&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Eliminar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-warning&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Editar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-info&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">copiar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">article</span><span class="token punctuation">&gt;</span>

</code></pre></div><h2 id="configurar-partials"><a href="#configurar-partials" class="header-anchor">#</a> Configurar Partials</h2> <ul><li>partials = sirve para  separar trozos de hbs que se van a repetir. (ciclos (each) , menu , footer , etc)</li> <li>en el partials puede ir  footer.hbs , navbar.hbs , etc.</li></ul> <h3 id="configuracion-2"><a href="#configuracion-2" class="header-anchor">#</a> Configuracion</h3> <p>index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Le decimos que la extension de los archivos de views es  .hbs y que los partials se encuentran en views/components</span>
<span class="token keyword">const</span> hbs <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    extname<span class="token operator">:</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span>
    partialsDir<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;views/components&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="llamar-a-un-partials"><a href="#llamar-a-un-partials" class="header-anchor">#</a> Llamar a un partials</h3> <p>Para llamar a un partial dentro de una plantilla</p> <p>home.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code>    <span class="token punctuation">&lt;</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span><span class="token variable">Hola</span> <span class="token variable">desde</span> <span class="token variable">Home</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">#</span><span class="token variable">each</span> <span class="token variable">urls</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
         <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">&gt;</span> <span class="token variable">Card</span>   <span class="token variable">url</span><span class="token punctuation">=</span><span class="token variable">this</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">/</span><span class="token variable">each</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
  

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Explicacion</p> <p>por cada iteraci칩n , invoca al Card.hbs  pasando como url cada componente del array urls</p></div> <p>Otra manera:
home.hbs:</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code>   <span class="token punctuation">&lt;</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span><span class="token variable">Hola</span> <span class="token variable">desde</span> <span class="token variable">Home</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">#</span><span class="token variable">each</span> <span class="token variable">urls</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
         <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">&gt;</span> <span class="token variable">Card</span>   <span class="token variable">item</span><span class="token punctuation">=</span><span class="token variable">this</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">/</span><span class="token variable">each</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
  

</code></pre></div><p>Card.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code> <span class="token punctuation">&lt;</span><span class="token variable">article</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card mb-2&quot;</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card-body&quot;</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">item</span><span class="token punctuation">.</span><span class="token variable">origen</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">item</span><span class="token punctuation">.</span><span class="token variable">shortUrl</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-danger&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Eliminar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-warning&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Editar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-info&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">copiar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">article</span><span class="token punctuation">&gt;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Le pod칠s quitar los datos opcionales (item=this o url=this) porque los datos del item del array se pasan solo al componente.</li> <li>A un componente nosotros le podemos mandar informaci칩n , esto se llama props en react y vue.</li></ul></div> <p>Creamos un men칰 que lo va a utilizar todo el sitio web</p> <p>views/components/Navbar.hbs</p> <div class="custom-block tip"><p class="custom-block-title">Convenciones</p> <p>Los nombre de los componentes arrancan con Mayuscula.</p></div> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token variable">nav</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;navbar navbar-expand-lg navbar-dark bg-primary&quot;</span><span class="token punctuation">&gt;</span>
  <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;container&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;navbar-brand&quot;</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Navbar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">button</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;navbar-toggler&quot;</span> <span class="token variable">type</span><span class="token punctuation">=</span><span class="token string">&quot;button&quot;</span> <span class="token variable">data-bs-toggle</span><span class="token punctuation">=</span><span class="token string">&quot;collapse&quot;</span> <span class="token variable">data-bs-target</span><span class="token punctuation">=</span><span class="token string">&quot;#navbarNavAltMarkup&quot;</span> <span class="token variable">aria-controls</span><span class="token punctuation">=</span><span class="token string">&quot;navbarNavAltMarkup&quot;</span> <span class="token variable">aria-expanded</span><span class="token punctuation">=</span><span class="token string">&quot;false&quot;</span> <span class="token variable">aria-label</span><span class="token punctuation">=</span><span class="token string">&quot;Toggle navigation&quot;</span><span class="token punctuation">&gt;</span>
      <span class="token punctuation">&lt;</span><span class="token variable">span</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;navbar-toggler-icon&quot;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">span</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">button</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;collapse navbar-collapse&quot;</span> <span class="token variable">id</span><span class="token punctuation">=</span><span class="token string">&quot;navbarNavAltMarkup&quot;</span><span class="token punctuation">&gt;</span>
      <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;navbar-nav ms-auto&quot;</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;nav-link active&quot;</span> <span class="token variable">aria-current</span><span class="token punctuation">=</span><span class="token string">&quot;page&quot;</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Home</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;nav-link&quot;</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/logup&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">LogUp</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;nav-link&quot;</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">LogIn</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;nav-link&quot;</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/logout&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">LogOut</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
      <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
  <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">nav</span><span class="token punctuation">&gt;</span>

</code></pre></div><p>main.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token punctuation">!</span><span class="token variable">DOCTYPE</span> <span class="token variable">html</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">html</span> <span class="token variable">lang</span><span class="token punctuation">=</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">charset</span><span class="token punctuation">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">http-equiv</span><span class="token punctuation">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;IE=edge&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">meta</span> <span class="token variable">name</span><span class="token punctuation">=</span><span class="token string">&quot;viewport&quot;</span> <span class="token variable">content</span><span class="token punctuation">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">title</span><span class="token punctuation">&gt;</span><span class="token variable">Desde</span> <span class="token variable">HBS</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">title</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token variable">link</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css&quot;</span> <span class="token variable">rel</span><span class="token punctuation">=</span><span class="token string">&quot;stylesheet&quot;</span> <span class="token variable">integrity</span><span class="token punctuation">=</span><span class="token string">&quot;sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3&quot;</span> <span class="token variable">crossorigin</span><span class="token punctuation">=</span><span class="token string">&quot;anonymous&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">head</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">&gt;</span> <span class="token variable">Navbar</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;container mt-5&quot;</span><span class="token punctuation">&gt;</span>
 <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">body</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
     
      <span class="token punctuation">&lt;</span><span class="token variable">script</span> <span class="token variable">src</span><span class="token punctuation">=</span><span class="token string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js&quot;</span> <span class="token variable">integrity</span><span class="token punctuation">=</span><span class="token string">&quot;sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p&quot;</span> <span class="token variable">crossorigin</span><span class="token punctuation">=</span><span class="token string">&quot;anonymous&quot;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">script</span><span class="token punctuation">&gt;</span>
      <span class="token punctuation">&lt;</span><span class="token variable">script</span> <span class="token variable">src</span><span class="token punctuation">=</span><span class="token string">&quot;/js/script.js&quot;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">script</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">html</span><span class="token punctuation">&gt;</span>

</code></pre></div><h2 id="router"><a href="#router" class="header-anchor">#</a> Router</h2> <p>Creamos la carpeta llamada routes</p> <p>Y dentro el archivo home.js</p> <div class="custom-block tip"><p class="custom-block-title">routes</p> <ul><li>Usamos el Router para crear manejadores de rutas modulares (permite trabajar en m칩dulos )</li> <li>Sirve para poner la l칩gica de una o varias rutas en un archivo y poder separarlos (m칩dulos), de forma que cada archivo es una ruta o un conjunto de rutas relacionadas.</li> <li>Lo recomendable es que cada archivo contenga la l칩gica de una  ruta para poder trabajar con m칩dulos.</li></ul></div> <p>routes/home.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span> <span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>origen<span class="token operator">:</span> <span class="token string">&quot;www.google.com&quot;</span> <span class="token punctuation">,</span> shortUrl<span class="token operator">:</span> <span class="token string">&quot;hfgdohdf&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>origen<span class="token operator">:</span> <span class="token string">&quot;www.google.com&quot;</span> <span class="token punctuation">,</span> shortUrl<span class="token operator">:</span> <span class="token string">&quot;hfgdohdf&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>origen<span class="token operator">:</span> <span class="token string">&quot;www.google.com&quot;</span> <span class="token punctuation">,</span> shortUrl<span class="token operator">:</span> <span class="token string">&quot;hfgdohdf&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home'</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>urls <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><p>Tambien creamos el archivo auth.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Observacion</p> <p>Como se puede ver cada archivo es una ruta (home = al apartado home  y auth.js = al apartado login)</p></div> <p>en el index.js</p> <p>Se utiliza el  middleware para usar el router</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express-handlebars&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> hbs <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    extname<span class="token operator">:</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span>
    partialsDir<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;views/components&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span> hbs<span class="token punctuation">.</span>engine<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;view engine&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;views&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./views&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>




app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Usamos el middleware para utilizar los routes</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span> <span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/home'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;/auth&quot;</span> <span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/auth'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">5000</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;server andando 游댠 http://localhost:5000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Resultado del middleware</p> <ul><li>Home =  http://localhost:5000   (No se utilizo ninguno prefijo (/))</li> <li>Login =  http://localhost:5000/auth/login (Ya que se a침adio el prefijo /auth)</li></ul></div> <p>Cambiamos las rutas en el navbar.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code> <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;nav-link&quot;</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/logup&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">LogUp</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;nav-link&quot;</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/auth/login&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">LogIn</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;nav-link&quot;</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/logout&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">LogOut</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>

</code></pre></div><h2 id="configuracion-mongodb"><a href="#configuracion-mongodb" class="header-anchor">#</a> Configuracion mongoDB</h2> <h3 id="en-el-sitio-de-mongodb"><a href="#en-el-sitio-de-mongodb" class="header-anchor">#</a> En el sitio de MongoDB</h3> <ol><li>Creamos un Cluster</li></ol> <ul><li>Database  Build a Database  Shared  Free</li> <li>Todas las configuraciones dejarla por defecto.</li> <li>Por ultimo le das a Create Cluster</li></ul> <ol start="2"><li>En network access especificamos las IP de donde nos queremos conectar</li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Puede ser:</p> <ul><li>nuestra IP (para mayor seguridad)</li> <li>Permitir que se pueda conectar desde cualquier ip(0.0.0.0)</li> <li>Un conjunto de IP (la nuestra y la de un servidor/hosting)</li></ul></div> <ol start="3"><li>En DataBase Access Creamos un usuario</li></ol> <div class="custom-block tip"><p class="custom-block-title">Ejemplo</p> <p>User: User_API
password: contrase침a</p></div> <ul><li>Built-in Role para  configurar  el Rol (Accesos)</li></ul> <div class="custom-block tip"><p class="custom-block-title">VERSION GRATIS</p> <ul><li>En el modo gratuito solo podemos tener un cluster</li> <li>Un cluster es como un servidor y puede tener varias BD</li> <li>En un cluster podemos tener muchas colecciones.</li></ul></div> <p>4.Database  Connect  Connect your app</p> <ul><li>Copiamos el uri</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>mongodb<span class="token operator">+</span>srv<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token operator">&lt;</span>username<span class="token operator">&gt;</span><span class="token operator">:</span><span class="token operator">&lt;</span>password<span class="token operator">&gt;</span>@cluster<span class="token punctuation">.</span>xcibc<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>net<span class="token operator">/</span>myFirstDatabase<span class="token operator">?</span>retryWrites<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>w<span class="token operator">=</span>majority

<span class="token comment">/*
- Borramos &lt;Username&gt; y ponemos  el usuario por el cual nos conectamos
- Borramos &lt;password&gt; y ponemos la contrase침a del usuario
- Borramos miFirstDateBase y ponemos el nombre de la BD a conectarse
*/</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Ejemplo</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">URI</span><span class="token operator">:</span>mongodb<span class="token operator">+</span>srv<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>User_API<span class="token operator">:</span>contrase침a@cluster<span class="token punctuation">.</span>xcibc<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>net<span class="token operator">/</span>dbUrl<span class="token operator">?</span>retryWrites<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>w<span class="token operator">=</span>majority
</code></pre></div></div> <h3 id="en-el-proyecto"><a href="#en-el-proyecto" class="header-anchor">#</a> En el proyecto</h3> <p>Creamos el archivo .gitignore</p> <div class="language-gitignore extra-class"><pre class="language-gitignore"><code><span class="token entry string">node_modules</span>
<span class="token entry string">.env</span>
</code></pre></div><p>Creamos el archivo .env</p> <div class="custom-block tip"><p class="custom-block-title">.env</p> <ul><li>En dicho archivo creamos variables protegidas que no se pueden subir a la nube  (github)</li> <li>Sirven para no exponer informacion privada</li> <li>Son variables de entorno</li> <li>Sintaxis: nombrevariable=valor</li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">URI</span><span class="token operator">=</span>mongodb<span class="token operator">+</span>srv<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>User_API<span class="token operator">:</span>contrase침a@cluster<span class="token punctuation">.</span>xcibc<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>net<span class="token operator">/</span>dbUrl<span class="token operator">?</span>retryWrites<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>w<span class="token operator">=</span>majority
</code></pre></div><p>Reiniciamos Nodemon ya que no lee el archivo.</p> <h3 id="modulos"><a href="#modulos" class="header-anchor">#</a> modulos</h3> <ul><li>Para manejar  MongoDb dentro de node.js usaremos mongosee</li> <li>el 늡ave es para versiones antiguas de npm</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code>npm install mongoose
</code></pre></div><p>Y para manejar las variables de entorno usaremos dotenv</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>npm i dotenv
</code></pre></div><h3 id="establecer-conexion"><a href="#establecer-conexion" class="header-anchor">#</a> Establecer conexion</h3> <p>Creamos la carpeta datebase</p> <p>Y dentro el archivo conexi칩n.js(Realizaremos la conexi칩n en dicho archivo)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Para conectarnos a la BD</span>
<span class="token comment">//connect (uri con los datos remplazados)</span>
<span class="token comment">// Accedemos al valor de la variable URI de .env</span>
<span class="token comment">// Sintaxis: process.env.NOMBREVARIABLE</span>

mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">URI</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Como devuelve una promesa , usamos el then</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;'db conectada 游댠&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Fallo la conexion&quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Lo llamamos en el index.js:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> create <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express-handlebars&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// Para leer las variables de entorno (para acceder a las variables de .env)</span>
 <span class="token comment">// config(configuraciones) -- Las configuraciones pueden ser desde cambiar el nombre del archivo .env a otras opciones</span>
 <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dotenv'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// Ejecutamos el archivo database/conexion.js</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./database/conexion'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> hbs <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    extname<span class="token operator">:</span> <span class="token string">&quot;.hbs&quot;</span><span class="token punctuation">,</span>
    partialsDir<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;views/components&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="volvemos-a-mongodb-sitio-web"><a href="#volvemos-a-mongodb-sitio-web" class="header-anchor">#</a> Volvemos a MongoDB(sitio web)</h3> <ul><li>Database  Cluster -- Browse Collections</li> <li>Te va a mostrar todas las BD.</li> <li>Si le das a Create Database , Creas una colecci칩n que va a pertenecer a una BD.</li></ul> <div class="custom-block tip"><p class="custom-block-title">Explicacion</p> <ul><li>Una colecci칩n tiene m칰ltiples documentos. Lo podes insertar con la opcion insert document  (El documento funciona igual que un objeto de JS propiedad:valor)</li> <li>El documento es un objeto de JS (con multiples metodos)</li> <li>Una BD puede tener m칰ltiples colleciones.</li></ul></div> <div class="custom-block tip"><p class="custom-block-title">Explicacion como si fuera relacional</p> <ul><li>Collecion = tabla</li> <li>Documento = Fila de la tabla</li> <li>Y cada propiedad del documento es una columna.</li></ul></div> <h2 id="modelo-esquema"><a href="#modelo-esquema" class="header-anchor">#</a> Modelo/Esquema</h2> <ul><li>Las colecciones van a tener documentos</li> <li>Y esos documentos est치n compuesto de varias propiedades con sus valores correspondiente.</li></ul> <div class="custom-block tip"><p class="custom-block-title">Modelo</p> <ul><li>En un modelo definimos el nombre de la colecci칩n y las propiedades(columnas) que van a tener sus documentos(filas)</li> <li>A traves del modelo tenemos acceso a m칠todos  para crear/modificar/leer/etc documentos.</li></ul></div> <div class="custom-block tip"><p class="custom-block-title">Esquema</p> <ul><li>Con Mongoose, todo se deriva de un esquema</li> <li>Cada esquema se asigna a una colecci칩n MongoDB y define la forma de los documentos dentro de esa colecci칩n.</li> <li>El esquema define la estructura de los documentos.</li></ul></div> <h3 id="en-el-proyecto-2"><a href="#en-el-proyecto-2" class="header-anchor">#</a> En el proyecto</h3> <p>Creamos la carpeta models</p> <ul><li>En dicha carpeta vamos a crear los modelos</li> <li>cremos el archivo Url.js en la carpeta</li></ul> <div class="custom-block tip"><p class="custom-block-title">ID</p> <p>La ID se genera de manera autom치tica , por eso no la especificamos.</p></div> <div class="custom-block tip"><p class="custom-block-title">Generar String aleatorios</p> <ul><li>Vamos a usar <a href="https://www.npmjs.com/package/nanoid" target="_blank" rel="noopener noreferrer">nanoid<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> para crear ids aleatorios</li> <li>npm i nanoid</li></ul></div> <div class="custom-block tip"><p class="custom-block-title">Explicacion</p> <ul><li>Para tener acceso a los m칠todos  para crear/modificar/leer/etc documentos , debemos crear un esquema y llevarlo a  un modelo.</li> <li>Se exporta el modelo no el esquema</li> <li>el esquema sirve para crear el modelo</li> <li>esquema = estructura del documento</li> <li>modelo = creado a partir del esquema , permite tener acceso a los m칠todos para el CRUD.</li></ul></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Al crearse un objeto de tipo  modelo(el que se crea), se crea la colecci칩n y la BD (si no existe)</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
<span class="token comment">// Obtenemos la clase Schema de mongosee</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>Schema<span class="token punctuation">}</span> <span class="token operator">=</span> mongoose
<span class="token keyword">const</span> <span class="token punctuation">{</span>nanoid<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nanoid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Esquema</span>
<span class="token comment">// Nueva instancia(objeto) de Schema</span>
<span class="token comment">// El schema recibe un objeto con las propiedades que va a tener cada documento  y sus restricciones.</span>
<span class="token keyword">const</span> urlSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

    origin<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// La propiedad origen es de tipo String  , es unico , y es obligatorio</span>
        type<span class="token operator">:</span> String<span class="token punctuation">,</span>
        unique<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    shortURL<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// La propiedad shortURL  es de tipo String , es unico , y es obligatorio.</span>
        type<span class="token operator">:</span> String<span class="token punctuation">,</span>
        unique<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// Por defecto su valor es un String aleatorio (supuestamente unico)</span>
        <span class="token comment">//nanoid(numero(representa el largo del string)) genera un string aleatorio</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token function">nanoid</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//Modelo</span>
<span class="token comment">// Singular y comienza en Mayuscula -- variable</span>
<span class="token comment">// models (nombre de la coleccion , esquema)</span>
<span class="token comment">// Si la coleccion no existe , se crea tanto la BD como la coleccion(en plural)</span>
<span class="token keyword">const</span> Url <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Url'</span><span class="token punctuation">,</span> urlSchema<span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Url<span class="token punctuation">;</span>

</code></pre></div><h2 id="controladores-mvc"><a href="#controladores-mvc" class="header-anchor">#</a> Controladores (MVC)</h2> <ul><li>Para trabajar  con el modelo vista  controlador</li> <li>creamos la carpeta controllers y  dentro el archivo homeController.js</li> <li>En dicho archivo vamos a tener toda la l칩gica de leer, actualizar, agregar, etc de la ruta Home</li> <li>En el modelo vista  controlador, la l칩gica debe separarse.</li></ul> <p>controllers/homeController.js:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">leerUrls</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>origen<span class="token operator">:</span> <span class="token string">&quot;www.google.com&quot;</span> <span class="token punctuation">,</span> shortUrl<span class="token operator">:</span> <span class="token string">&quot;hfgdohdf&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>origen<span class="token operator">:</span> <span class="token string">&quot;www.google.com&quot;</span> <span class="token punctuation">,</span> shortUrl<span class="token operator">:</span> <span class="token string">&quot;hfgdohdf&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>origen<span class="token operator">:</span> <span class="token string">&quot;www.google.com&quot;</span> <span class="token punctuation">,</span> shortUrl<span class="token operator">:</span> <span class="token string">&quot;hfgdohdf&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home'</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>urls <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

   module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>leerUrls<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>routes/home.js:</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>leerUrls<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../controllers/homeController'</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span> <span class="token punctuation">,</span> leerUrls<span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">MVC</p> <ul><li>Modelo vista controlador</li> <li>controladores  modelo  vistas -routes  database</li></ul></div> <p>Hacemos el agregarUrl</p> <p>homeController.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">agregarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>routes/home.js</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span> <span class="token punctuation">,</span> agregarUrl<span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>
</code></pre></div><h2 id="instanciar-un-modelo"><a href="#instanciar-un-modelo" class="header-anchor">#</a> Instanciar un modelo</h2> <p>Creamos un componente llamado Form.hbs</p> <p>components/Form.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token punctuation">&lt;</span><span class="token variable">form</span> <span class="token variable">action</span><span class="token punctuation">=</span><span class="token string">&quot;/&quot;</span> <span class="token variable">method</span><span class="token punctuation">=</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">input</span> <span class="token variable">type</span><span class="token punctuation">=</span><span class="token string">&quot;text&quot;</span> <span class="token variable">placeholder</span><span class="token punctuation">=</span><span class="token string">&quot;Ingrese URL&quot;</span> <span class="token variable">name</span><span class="token punctuation">=</span><span class="token string">&quot;origin&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;form-control my-2&quot;</span><span class="token punctuation">&gt;</span>
 <span class="token punctuation">&lt;</span><span class="token variable">button</span> <span class="token variable">type</span><span class="token punctuation">=</span><span class="token string">&quot;submit&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-primary w-100 mb-2&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Agregar</span> <span class="token variable">Url</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">button</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">form</span><span class="token punctuation">&gt;</span>

</code></pre></div><p>views/home.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code>  <span class="token punctuation">&lt;</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span><span class="token variable">Agrege</span> <span class="token variable">sus</span> <span class="token variable">URL</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">h1</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">&gt;</span> <span class="token variable">Form</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">#</span><span class="token variable">each</span> <span class="token variable">urls</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
         <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">&gt;</span> <span class="token variable">Card</span>   <span class="token variable">item</span><span class="token punctuation">=</span><span class="token variable">this</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">/</span><span class="token variable">each</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

</code></pre></div><p>homeController.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Importamos el modelo</span>
<span class="token keyword">const</span> Url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/Url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">agregarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Creamos una instancia(objeto) del modelo</span>
        <span class="token comment">// new Modelo({propiedades del esquema})</span>
        <span class="token comment">//shortUrl tiene un valor por defecto , no hace falta mandarlo</span>
       <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Url</span><span class="token punctuation">(</span><span class="token punctuation">{</span>origin<span class="token operator">:</span><span class="token string">'estatico'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
   module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Explicacion</p> <ul><li>Al momento de instanciar un Modelo, se crea la BD y la colecci칩n.</li> <li>La instancia es un objeto (documento mongoDB) con todas las propiedades del esquema.</li></ul></div> <h2 id="guardar-en-la-bd"><a href="#guardar-en-la-bd" class="header-anchor">#</a> Guardar en la BD</h2> <p>modificamos el archivo homeController.js para que al documento mongoDB creado (instancia) se guarde en la BD.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">agregarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
       <span class="token comment">// Creamos una instancia(objeto) del modelo</span>
       <span class="token comment">// new Modelo({propiedades del esquema})</span>
       <span class="token comment">//shortUrl tiene un valor por defecto , no hace falta mandarlo</span>
      <span class="token comment">// La ID se crea por defecto , no hace falta mandarlo</span>
      <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Url</span><span class="token punctuation">(</span><span class="token punctuation">{</span>origin<span class="token operator">:</span><span class="token string">'estatico'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// Lo guardamos en la BD // Insertamos un documento(fila) en la colecci칩n(tabla)</span>
      <span class="token keyword">await</span> url<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// Direcciono a la pagina raiz</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
       res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="ahora-vamos-a-hacer-que-se-guarde-en-la-bd-la-informacion-que-se-envia-en-el-formulario"><a href="#ahora-vamos-a-hacer-que-se-guarde-en-la-bd-la-informacion-que-se-envia-en-el-formulario" class="header-anchor">#</a> Ahora vamos a hacer que se guarde en la BD, la informaci칩n que se env칤a en el formulario:</h3> <ol><li>Configuramos el middleware para que se pueda leer el body, ya que el formulario utiliza el m칠todo POST</li></ol> <p>index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Habilitamos los formularios html POST</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>extended<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><ol start="2"><li>Configuramos homeController.js para que a침ada el dato enviado del formulario a la BD.</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">agregarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token comment">// La informacion enviada por el formulario</span>
   <span class="token keyword">const</span> <span class="token punctuation">{</span>origin<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
       <span class="token comment">// Creamos una instancia(objeto) del modelo</span>
       <span class="token comment">// new Modelo({propiedades del esquema})</span>
       <span class="token comment">//shortUrl tiene un valor por defecto , no hace falta mandarlo</span>
      <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Url</span><span class="token punctuation">(</span><span class="token punctuation">{</span>origin<span class="token operator">:</span>origin <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// Lo guardamos en la BD // Insertamos un documento(fila) en la colecci칩n(tabla)</span>
      <span class="token keyword">await</span> url<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// Direcciono a la pagina raiz</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
       res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><ol start="3"><li>Movemos la funcion nanoid() al homeController para que no genere conflictos ya que genera el mismo shortUrl para todos los documentos y no deja guardar mas de 2 veces</li></ol> <p>homeController.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Importamos el modelo</span>
<span class="token keyword">const</span> Url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/Url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>nanoid<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nanoid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">agregarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token comment">// La informacion enviada por el formulario</span>
   <span class="token keyword">const</span> <span class="token punctuation">{</span>origin<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
       <span class="token comment">// Creamos una instancia(objeto) del modelo</span>
       <span class="token comment">// new Modelo({propiedades del esquema})</span>
      <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Url</span><span class="token punctuation">(</span><span class="token punctuation">{</span>origin<span class="token operator">:</span>origin <span class="token punctuation">,</span> shortURL<span class="token operator">:</span><span class="token function">nanoid</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
       <span class="token comment">// Lo guardamos en la BD // Insertamos un documento(fila) en la colecci칩n(tabla)</span>

      <span class="token keyword">await</span> url<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// Direcciono a la pagina raiz</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
       res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>models/Url.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Esquema</span>
<span class="token comment">// Nueva instancia(objeto) de Schema</span>
<span class="token comment">// El schema recibe un objeto con las propiedades que va a tener cada documento  y sus restricciones.</span>
<span class="token keyword">const</span> urlSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

   origin<span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token comment">// La propiedad origen es de tipo String  , es unico , y es obligatorio</span>
       type<span class="token operator">:</span> String<span class="token punctuation">,</span>
       unique<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
       required<span class="token operator">:</span> <span class="token boolean">true</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   shortURL<span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token comment">// La propiedad shortURL  es de tipo String , es unico , y es obligatorio.</span>
       type<span class="token operator">:</span> String<span class="token punctuation">,</span>
       unique<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
       required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="leer-datos"><a href="#leer-datos" class="header-anchor">#</a> Leer datos</h2> <p>Ahora vamos a hacer que se muestre la informacion de la BD en la pagina de inicio(home)</p> <p>views/components/Card.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code> <span class="token punctuation">&lt;</span><span class="token variable">article</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card mb-2&quot;</span><span class="token punctuation">&gt;</span>
       <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card-body&quot;</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">origin</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">shortURL</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-danger&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Eliminar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-warning&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Editar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-info&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">copiar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
       <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
   <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">article</span><span class="token punctuation">&gt;</span>

</code></pre></div><p>controllers/homeController.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">leerUrls</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// find(parametros opcionales) Busca todos los documentos de la coleccion(modelo)</span>
      <span class="token comment">// Select * from coleccion</span>
     <span class="token comment">// Puede tener parametros para filtrar documentos</span>
     <span class="token comment">// Devuelve un array con objetos de mongoDB</span>
     <span class="token comment">//lean() convierte un objeto de mongoDB en un objeto JS</span>
     <span class="token keyword">const</span> urls <span class="token operator">=</span> <span class="token keyword">await</span> Url<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//urls:urls</span>
     res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home'</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>urls<span class="token operator">:</span>urls <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'fallo algo...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

   <span class="token punctuation">}</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">opcion Lean</p> <ul><li>La opci칩n Lean le dice a Mongoose que omita la hidrataci칩n de los documentos de resultados. Esto hace que las consultas sean m치s r치pidas y requieran menos memoria, pero los documentos de resultados son simples objetos JavaScript, no documentos Mongoose.</li></ul></div> <div class="custom-block tip"><p class="custom-block-title">hidratacion</p> <ul><li>La hidrataci칩n se refiere al proceso de llenar un objeto con datos. Un objeto que a칰n no se ha hidratado se ha instanciado y representa una entidad que s칤 tiene datos, pero los datos a칰n no se han cargado en el objeto. Esto es algo que se hace por razones de rendimiento.</li> <li>Se podr칤a decir que un objeto est치 parcialmente hidratado cuando solo ha cargado algunos de los campos, pero no todos. Esto se puede hacer porque esos otros campos no son necesarios para sus operaciones actuales. Por lo tanto, no hay raz칩n para desperdiciar el ancho de banda y los ciclos de CPU cargando, transfiriendo y configurando estos datos cuando no se van a usar.</li></ul></div> <h2 id="eliminar-datos"><a href="#eliminar-datos" class="header-anchor">#</a> Eliminar datos</h2> <p>Ahora vamos a permitir que se puedan eliminar documentos en la BD:</p> <ul><li><a href="https://mongoosejs.com/docs/api.html#model_Model.findByIdAndDelete" target="_blank" rel="noopener noreferrer">Info<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li>Forma no muy recomendada (utilizar peticion GET)</li> <li>Lo ideal seria utilizar una petici칩n DELETE ,  NO GET pero en HTML solo se puede hacer GET y POST</li></ul></div> <p>views/components/Card.hbs</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code> <span class="token punctuation">&lt;</span><span class="token variable">article</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card mb-2&quot;</span><span class="token punctuation">&gt;</span>
       <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card-body&quot;</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">origin</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">shortURL</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/eliminar/{{item._id}}&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-danger&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Eliminar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-warning&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Editar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
           <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-info&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">copiar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
       <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
   <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">article</span><span class="token punctuation">&gt;</span>

</code></pre></div><p>routes/home.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// NO RECOMENDADO , para eliminacion informacion se usa el metodo DELETE</span>
<span class="token comment">// usar los dos puntos (:) para asignar una variable</span>
<span class="token comment">//ruta /eliminar/:nombrevariable</span>
<span class="token comment">//ruta /eliminar/valornombrevariable</span>
<span class="token comment">// Ejemplo: /eliminar/6220bd6df4eaa23f425ac827</span>
<span class="token comment">// nombrevariable  =  6220bd6df4eaa23f425ac827</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/eliminar/:id&quot;</span> <span class="token punctuation">,</span> eliminarUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><p>homeController.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">eliminarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// en req.params estan todas las variables  de rutas(:nombrevariable) y sus valores correspondiente</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Busca una coleccion por la ID y lo elimina</span>
       <span class="token keyword">await</span> Url<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
       res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
         res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

   module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl <span class="token punctuation">,</span> eliminarUrl<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="validacion-con-middlewares"><a href="#validacion-con-middlewares" class="header-anchor">#</a> Validacion con middlewares</h2> <div class="custom-block tip"><p class="custom-block-title">middlewares</p> <ul><li>Intercepta la petici칩n antes de la respuesta del servidor (gesti칩n de rutas), incluso antes de que lo analice el servidor.</li> <li>Se suele usar para las validaciones y autenticaciones.</li> <li>Un middleware es una funci칩n con tres par치metros (req , res , next)</li> <li>next = Siga con la siguiente solicitud, que la petici칩n pase a otro middleware o que llegue al servidor.</li> <li>Se podr칤a decir que el middleware es un cortafuego y si la petici칩n es v치lida, pasa al servidor para ser tratada.</li></ul> <p>En caso que la petici칩n no sea v치lida, nunca llega al servidor , sin embargo el middleware le env칤a una respuesta al cliente.</p></div> <p>Creamos la carpeta middlewares y Adentro urlValida.js</p> <p>Para validar una Url</p> <ul><li><a href="https://nodejs.org/api/url.html#class-url" target="_blank" rel="noopener noreferrer">Usamos este modulo nativo de node.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-js extra-class"><pre class="language-js"><code> 
 <span class="token comment">// Modulo que viene incorporado con Node.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">URL</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">urlValidar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res <span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token comment">// Si todo esta correcto llamamos a next</span>
 <span class="token comment">// next = eliminarUrl</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Leo el body del formulario</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> origin <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
        <span class="token comment">// Se crea una nueva instancia de URL con la informacion del formulario</span>
        <span class="token keyword">const</span> urlFrontend <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//La instancia(objeto) tiene la propiedad origin</span>
        <span class="token comment">//Si es distinto a null , tiene el formato de url</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>urlFrontend<span class="token punctuation">.</span>origin <span class="token operator">!==</span> <span class="token string">&quot;null&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Comprueba que tenga el protocolo http o https y si lo tiene llama al next()</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>
                urlFrontend<span class="token punctuation">.</span>protocol <span class="token operator">===</span> <span class="token string">&quot;http:&quot;</span> <span class="token operator">||</span>
                urlFrontend<span class="token punctuation">.</span>protocol <span class="token operator">===</span> <span class="token string">&quot;https:&quot;</span>
            <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Lanzamos un error en caso que no sea valida</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;no v치lida 游&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// console.log(error);</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;url no valida&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> urlValidar<span class="token punctuation">;</span>

</code></pre></div><p>routes/home.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//Cuando se entra a la ruta , se ejecuta el middleware (urlValida).</span>
<span class="token comment">// El middleware lo analiza, si la peticion es valida, envia la peticion al agregarUrl(req,res)(pasa al siguiente - next).</span>
<span class="token comment">// En caso que la petici칩n es invalida , el middleware se encarga de responder a la peticion</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span> <span class="token punctuation">,</span> urlValida <span class="token punctuation">,</span> agregarUrl<span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/eliminar/:id&quot;</span>  <span class="token punctuation">,</span> eliminarUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><h2 id="editar-en-mongodb"><a href="#editar-en-mongodb" class="header-anchor">#</a> Editar en MongoDB</h2> <ul><li><a href="https://mongoosejs.com/docs/queries.html" target="_blank" rel="noopener noreferrer">Info<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Se hace con el m칠todo HTTP PUT pero en este ejemplo se realizara con GET (NO RECOMENDADO)</p></div> <p>routes/home.js</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/eliminar/:id&quot;</span>  <span class="token punctuation">,</span> eliminarUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/editar/:id&quot;</span><span class="token punctuation">,</span> editarUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><p>homeController.js</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> <span class="token function-variable function">editarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//variable id de la ruta</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// En la coleccion(modelo) buscamos un documento cuya id sea igual al valor de la variable const id</span>
        <span class="token comment">// Como nos trae un objeto mongoDB lo convertirmos en un objeto JS con lean()</span>
       <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">await</span> Url<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lean</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       
       <span class="token comment">// {url:url}</span>
       <span class="token comment">// el each del home.hbs ni se va a ejecutar ya que no le estamos pasando un array</span>
       res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
   module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl <span class="token punctuation">,</span> eliminarUrl <span class="token punctuation">,</span> editarUrl<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>En views/components/Card.hbs Modificamos el atributo href de editar</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code>    <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/editar/{{item._id}}&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-warning&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Editar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
</code></pre></div><p>en views/components/Form.hbs</p> <div class="custom-block tip"><p class="custom-block-title">logica</p> <p>Si existe url , crea una formulario para editar , si no existe crea el formulario para crear.</p></div> <div class="language-hbs extra-class"><pre class="language-hbs"><code><span class="token delimiter punctuation">{{</span><span class="token block keyword">#if</span> <span class="token variable">url</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
   <span class="token punctuation">&lt;</span><span class="token variable">form</span> <span class="token variable">action</span><span class="token punctuation">=</span><span class="token string">&quot;/editar/{{url._id}}&quot;</span> <span class="token variable">method</span><span class="token punctuation">=</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">input</span>  <span class="token variable">value</span><span class="token punctuation">=</span><span class="token string">&quot;{{url.origin}}&quot;</span> <span class="token variable">type</span><span class="token punctuation">=</span><span class="token string">&quot;text&quot;</span> <span class="token variable">placeholder</span><span class="token punctuation">=</span><span class="token string">&quot;Ingrese URL&quot;</span> <span class="token variable">name</span><span class="token punctuation">=</span><span class="token string">&quot;origin&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;form-control my-2&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">button</span> <span class="token variable">type</span><span class="token punctuation">=</span><span class="token string">&quot;submit&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-warning w-100 mb-2&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Editar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">button</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">form</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">else</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">&lt;</span><span class="token variable">form</span> <span class="token variable">action</span><span class="token punctuation">=</span><span class="token string">&quot;/&quot;</span> <span class="token variable">method</span><span class="token punctuation">=</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">input</span> <span class="token variable">type</span><span class="token punctuation">=</span><span class="token string">&quot;text&quot;</span> <span class="token variable">placeholder</span><span class="token punctuation">=</span><span class="token string">&quot;Ingrese URL&quot;</span> <span class="token variable">name</span><span class="token punctuation">=</span><span class="token string">&quot;origin&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;form-control my-2&quot;</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token variable">button</span> <span class="token variable">type</span><span class="token punctuation">=</span><span class="token string">&quot;submit&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-primary w-100 mb-2&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Agregar</span> <span class="token variable">Url</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">button</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">form</span><span class="token punctuation">&gt;</span>

<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">/</span><span class="token variable">if</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

</code></pre></div><p>home.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl <span class="token punctuation">,</span> eliminarUrl <span class="token punctuation">,</span> editarUrlForm <span class="token punctuation">,</span> editarUrl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../controllers/homeController'</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span> <span class="token punctuation">,</span> leerUrls<span class="token punctuation">)</span>
<span class="token comment">//Cuando se entra a la ruta , se ejecuta el middleware (urlValida).</span>
<span class="token comment">// Si el middleware detecta que la  peticion es valida, envia la peticion a agregarUrl(req,res)(al siguiente - next)</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span> <span class="token punctuation">,</span> urlValida <span class="token punctuation">,</span> agregarUrl<span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/eliminar/:id&quot;</span>  <span class="token punctuation">,</span> eliminarUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/editar/:id&quot;</span><span class="token punctuation">,</span> editarUrlForm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Utiliza el middleware</span>
<span class="token comment">// Si la url es valida , la petici칩n la gestiona editarUrl(req,res)</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/editar/:id&quot;</span> <span class="token punctuation">,</span>urlValida <span class="token punctuation">,</span>  editarUrl<span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><p>homeController.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Importamos el modelo</span>
<span class="token keyword">const</span> Url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/Url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>nanoid<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nanoid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">leerUrls</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// find(parametros opcionales) Busca todos los documentos de la coleccion(modelo)</span>
      <span class="token comment">// Select * from coleccion</span>
     <span class="token comment">// Puede tener parametros para filtrar documentos</span>
     <span class="token comment">// Devuelve un array con objetos de mongoDB</span>
     <span class="token comment">//lean() convierte un objeto de mongoDB en un objeto JS</span>
     <span class="token keyword">const</span> urls <span class="token operator">=</span> <span class="token keyword">await</span> Url<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//urls:urls</span>
     res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home'</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>urls<span class="token operator">:</span>urls <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'fallo algo...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

   <span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">agregarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> <span class="token punctuation">{</span>origin<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Url</span><span class="token punctuation">(</span><span class="token punctuation">{</span>origin<span class="token operator">:</span>origin <span class="token punctuation">,</span> shortURL<span class="token operator">:</span><span class="token function">nanoid</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">await</span> url<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
       res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">eliminarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token comment">// en req.params estan todas las variables  de ruta(:nombrevariable) y sus valores correspondiente</span>
   <span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
       <span class="token comment">// Busca una coleccion por la ID y lo elimina</span>
      <span class="token keyword">await</span> Url<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">editarUrlForm</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token comment">//variable id de la ruta</span>
   <span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
       <span class="token comment">// En la coleccion(modelo) buscamos un documento cuya id sea igual al valor de la variable const id</span>
       <span class="token comment">// Como nos trae un objeto mongoDB lo convertirmos en un objeto JS con lean()</span>
      <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">await</span> Url<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lean</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      
      <span class="token comment">// {url:url}</span>
      <span class="token comment">// el each del home.hbs ni se va a ejecutar ya que no le estamos pasando un array</span>
      res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'home'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
       res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">editarUrl</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token comment">//variable id de la ruta</span>
   <span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
   <span class="token keyword">const</span> <span class="token punctuation">{</span>origin<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
       <span class="token comment">// Buscamos el documento por la id y lo actualizamos</span>
       <span class="token comment">//findByIdAndUpdate(id , {informacion a modificar} )</span>
       <span class="token comment">// origin : origin</span>
      <span class="token keyword">await</span> Url<span class="token punctuation">.</span><span class="token function">findByIdAndUpdate</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token punctuation">{</span>origin<span class="token punctuation">}</span><span class="token punctuation">)</span>
      res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
   <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
       res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;error algo fallo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl <span class="token punctuation">,</span> eliminarUrl <span class="token punctuation">,</span> editarUrlForm <span class="token punctuation">,</span> editarUrl<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="clipboard"><a href="#clipboard" class="header-anchor">#</a> clipboard</h2> <p>Para copiar en el portapapeles la urlShort vamos a trabajar con el frontend</p> <p>Card.hbs:</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code> <span class="token punctuation">&lt;</span><span class="token variable">article</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card mb-2&quot;</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token variable">div</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;card-body&quot;</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">origin</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">p</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token variable">this</span><span class="token punctuation">.</span><span class="token variable">shortURL</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">p</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/eliminar/{{item._id}}&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-danger&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Eliminar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">a</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;/editar/{{item._id}}&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-warning&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">Editar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">a</span><span class="token punctuation">&gt;</span>
            <span class="token punctuation">&lt;</span><span class="token variable">button</span> <span class="token variable">data-short</span><span class="token punctuation">=</span><span class="token string">&quot;{{item.shortURL}}&quot;</span> <span class="token variable">href</span><span class="token punctuation">=</span><span class="token string">&quot;#&quot;</span> <span class="token variable">class</span><span class="token punctuation">=</span><span class="token string">&quot;btn btn-info&quot;</span><span class="token punctuation">&gt;</span><span class="token variable">copiar</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">button</span><span class="token punctuation">&gt;</span>
        <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">div</span><span class="token punctuation">&gt;</span>
    <span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">article</span><span class="token punctuation">&gt;</span>

</code></pre></div><p>main.hbs:</p> <div class="language-hbs extra-class"><pre class="language-hbs"><code>  <span class="token punctuation">&lt;</span><span class="token variable">script</span> <span class="token variable">src</span><span class="token punctuation">=</span><span class="token string">&quot;/js/app.js&quot;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">script</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">body</span><span class="token punctuation">&gt;</span>
<span class="token punctuation">&lt;</span><span class="token punctuation">/</span><span class="token variable">html</span><span class="token punctuation">&gt;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>A partir de ahora trabajamos con el frontend</p></div> <p>public/js/app.js:</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span> <span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>short<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:5000/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>short<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
         <span class="token comment">// Usamos el clipboard para copiar la const url  en el portapapeles</span>
         <span class="token comment">// Que se copie(Control + C) para luego pegar la url en donde quieras</span>
         navigator<span class="token punctuation">.</span>clipboard
            <span class="token punctuation">.</span><span class="token function">writeText</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Text copied to clipboard...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Something went wrong&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="redireccionamiento"><a href="#redireccionamiento" class="header-anchor">#</a> Redireccionamiento</h2> <p>Vamos a hacer  que el short te lleve a la url indicada (origin)</p> <p>routes/home.js:</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl <span class="token punctuation">,</span> eliminarUrl <span class="token punctuation">,</span> editarUrlForm <span class="token punctuation">,</span> editarUrl <span class="token punctuation">,</span> redireccionamiento<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../controllers/homeController'</span> <span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/:url&quot;</span> <span class="token punctuation">,</span> redireccionamiento<span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><p>homeController.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">redireccionamiento</span> <span class="token operator">=</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>url<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Buscamos un documento de la coleccion Url</span>
        <span class="token comment">// Lo buscamos por la propiedad shortUrl</span>
       <span class="token keyword">const</span> urlDB <span class="token operator">=</span> <span class="token keyword">await</span> Url<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>shortUrl<span class="token operator">:</span> url<span class="token punctuation">}</span><span class="token punctuation">)</span>
       res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span>urlDB<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
   module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>leerUrls <span class="token punctuation">,</span> agregarUrl <span class="token punctuation">,</span> eliminarUrl <span class="token punctuation">,</span> editarUrlForm <span class="token punctuation">,</span> editarUrl <span class="token punctuation">,</span> redireccionamiento<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="pasar-a-otro"><a href="#pasar-a-otro" class="header-anchor">#</a> Pasar a otro</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>JWT = SESION SIN ESTADO</p></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Session y  Passport(asi se trabajaba antes)  puede ser remplazado por JWT</p> <p>Flash para comunicar mensaje</p></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>API REST = NO TRABAJAR CON SESIONES (NO GUARDAR SESIONES EN EL SERVIDOR)</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/aprendizaje/Node/token.html" class="prev">
        Token y Practica API REST
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/aprendizaje/assets/js/app.11b5cd3b.js" defer></script><script src="/aprendizaje/assets/js/2.c431ec36.js" defer></script><script src="/aprendizaje/assets/js/43.860d12d1.js" defer></script>
  </body>
</html>
