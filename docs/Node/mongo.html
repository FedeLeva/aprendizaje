<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDB | Guias</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Descripcion">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/aprendizaje/assets/css/0.styles.5e6ce45c.css" as="style"><link rel="preload" href="/aprendizaje/assets/js/app.c8ef5d59.js" as="script"><link rel="preload" href="/aprendizaje/assets/js/2.c431ec36.js" as="script"><link rel="preload" href="/aprendizaje/assets/js/45.9c247c80.js" as="script"><link rel="prefetch" href="/aprendizaje/assets/js/10.e744f38e.js"><link rel="prefetch" href="/aprendizaje/assets/js/11.1da570f8.js"><link rel="prefetch" href="/aprendizaje/assets/js/12.2d9c2fa4.js"><link rel="prefetch" href="/aprendizaje/assets/js/13.9d5c8d4f.js"><link rel="prefetch" href="/aprendizaje/assets/js/14.ac7318bb.js"><link rel="prefetch" href="/aprendizaje/assets/js/15.0dc76b53.js"><link rel="prefetch" href="/aprendizaje/assets/js/16.e127c599.js"><link rel="prefetch" href="/aprendizaje/assets/js/17.38e9d24d.js"><link rel="prefetch" href="/aprendizaje/assets/js/18.917bc518.js"><link rel="prefetch" href="/aprendizaje/assets/js/19.a7f4a9f4.js"><link rel="prefetch" href="/aprendizaje/assets/js/20.980fa4da.js"><link rel="prefetch" href="/aprendizaje/assets/js/21.7018fded.js"><link rel="prefetch" href="/aprendizaje/assets/js/22.b8cc6940.js"><link rel="prefetch" href="/aprendizaje/assets/js/23.e516d08e.js"><link rel="prefetch" href="/aprendizaje/assets/js/24.e1eea224.js"><link rel="prefetch" href="/aprendizaje/assets/js/25.a04b8061.js"><link rel="prefetch" href="/aprendizaje/assets/js/26.a32980c2.js"><link rel="prefetch" href="/aprendizaje/assets/js/27.d8bab02d.js"><link rel="prefetch" href="/aprendizaje/assets/js/28.9898f043.js"><link rel="prefetch" href="/aprendizaje/assets/js/29.edfc8fa0.js"><link rel="prefetch" href="/aprendizaje/assets/js/3.0d887c6d.js"><link rel="prefetch" href="/aprendizaje/assets/js/30.252a3879.js"><link rel="prefetch" href="/aprendizaje/assets/js/31.914b9374.js"><link rel="prefetch" href="/aprendizaje/assets/js/32.7c8797ab.js"><link rel="prefetch" href="/aprendizaje/assets/js/33.aa552d3e.js"><link rel="prefetch" href="/aprendizaje/assets/js/34.961d4adc.js"><link rel="prefetch" href="/aprendizaje/assets/js/35.183d4b13.js"><link rel="prefetch" href="/aprendizaje/assets/js/36.b2c46711.js"><link rel="prefetch" href="/aprendizaje/assets/js/37.4486e40c.js"><link rel="prefetch" href="/aprendizaje/assets/js/38.d5c9d1ca.js"><link rel="prefetch" href="/aprendizaje/assets/js/39.2b76f93e.js"><link rel="prefetch" href="/aprendizaje/assets/js/4.7b66cd35.js"><link rel="prefetch" href="/aprendizaje/assets/js/40.65a94932.js"><link rel="prefetch" href="/aprendizaje/assets/js/41.8efcea3c.js"><link rel="prefetch" href="/aprendizaje/assets/js/42.c441fa36.js"><link rel="prefetch" href="/aprendizaje/assets/js/43.afa9d588.js"><link rel="prefetch" href="/aprendizaje/assets/js/44.3f345367.js"><link rel="prefetch" href="/aprendizaje/assets/js/46.03db1482.js"><link rel="prefetch" href="/aprendizaje/assets/js/47.1868bb9b.js"><link rel="prefetch" href="/aprendizaje/assets/js/48.9c9b68b0.js"><link rel="prefetch" href="/aprendizaje/assets/js/49.e7c50fb4.js"><link rel="prefetch" href="/aprendizaje/assets/js/5.a396fb32.js"><link rel="prefetch" href="/aprendizaje/assets/js/50.e62319bd.js"><link rel="prefetch" href="/aprendizaje/assets/js/51.743ca850.js"><link rel="prefetch" href="/aprendizaje/assets/js/52.5092ad73.js"><link rel="prefetch" href="/aprendizaje/assets/js/53.19e883ce.js"><link rel="prefetch" href="/aprendizaje/assets/js/54.6b8ebc03.js"><link rel="prefetch" href="/aprendizaje/assets/js/55.f2a00bc6.js"><link rel="prefetch" href="/aprendizaje/assets/js/56.ea9e0841.js"><link rel="prefetch" href="/aprendizaje/assets/js/57.96953294.js"><link rel="prefetch" href="/aprendizaje/assets/js/58.da528450.js"><link rel="prefetch" href="/aprendizaje/assets/js/6.27888615.js"><link rel="prefetch" href="/aprendizaje/assets/js/7.06129e92.js"><link rel="prefetch" href="/aprendizaje/assets/js/8.eeef72c8.js"><link rel="prefetch" href="/aprendizaje/assets/js/9.7e901376.js">
    <link rel="stylesheet" href="/aprendizaje/assets/css/0.styles.5e6ce45c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/aprendizaje/" class="home-link router-link-active"><!----> <span class="site-name">Guias</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/aprendizaje/" class="nav-link">
  Inicio
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/aprendizaje/" class="nav-link">
  Inicio
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/aprendizaje/Node/" aria-current="page" class="sidebar-link">Lo Basico de Node</a></li><li><a href="/aprendizaje/Node/motor.html" class="sidebar-link">Motores de plantillas/vistas</a></li><li><a href="/aprendizaje/Node/router.html" class="sidebar-link">Router</a></li><li><a href="/aprendizaje/Node/mongo.html" aria-current="page" class="active sidebar-link">MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/aprendizaje/Node/mongo.html#mongoose" class="sidebar-link">Mongoose</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/mongo.html#schema" class="sidebar-link">Schema</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/mongo.html#find" class="sidebar-link">find()</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/mongo.html#varibles-de-entorno" class="sidebar-link">Varibles de entorno</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/mongo.html#bodyparser" class="sidebar-link">bodyParser</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/mongo.html#crear" class="sidebar-link">Crear</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/mongo.html#get-unico-documento" class="sidebar-link">Get único documento</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/mongo.html#delete-documento" class="sidebar-link">Delete documento</a></li><li class="sidebar-sub-header"><a href="/aprendizaje/Node/mongo.html#editar-documento" class="sidebar-link">Editar documento</a></li></ul></li><li><a href="/aprendizaje/Node/token.html" class="sidebar-link">Token y Practica API REST</a></li><li><a href="/aprendizaje/Node/Guia.html" class="sidebar-link">Guia practica - 2022</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mongodb"><a href="#mongodb" class="header-anchor">#</a> MongoDB</h1> <ul><li>Es una base de datos que puede trabajar en la nube.</li> <li><a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">info<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Tiene un plan gratis.</li> <li>Base de datos no relacional y que nos permite trabajar con la nube sin necesidad de hacer mayores instalaciones en nuestro equipo.</li></ul> <h3 id="pasos-en-el-sitio-web"><a href="#pasos-en-el-sitio-web" class="header-anchor">#</a> Pasos en el sitio web</h3> <p><a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">sitio web<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li>Nos regristamos (Que es gratis)</li> <li>Creamos nuestro Cluster</li></ol> <ul><li>Puedes dejar todo por defecto para que no exitan cargos monetarios en tu cuenta</li> <li>El plan gratuito está limitado a un Cluster</li> <li>Pueden cambiar el nombre del Cluster.</li></ul> <ol start="3"><li>Esperar(crear el cluster lleva algunos minutos)</li> <li>Crear una coleccion(collection)
<ol><li>Le das a add my own data</li> <li>Nos pedira el nombre de la base de datos (en un cluster puede haber varias BD ojo).</li> <li>Nos pedirá el nombre de la colección  que seria como el nombre de una tabla</li></ol></li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>En este ejemplo:</p> <p>Nombre de BD: veterinaria</p> <p>Nombre de colección: mascotas</p></div> <div class="custom-block tip"><p class="custom-block-title">Explicacion como si fuera una BD relacional</p> <ul><li>Seria como añadir una tabla a la base de datos veterinaria, en este ejemplo se creo la colección (tabla) mascotas para almacenar los datos de las mascotas.</li> <li>Una Base de datos puede tener muchas colecciones (tablas)</li></ul></div> <ol start="5"><li>Seleccionamos la coleccion mascota</li> <li>Le damos a insert document</li></ol> <ul><li>Equivalente a añadir una fila a la tabla</li> <li>Cada fila es un objeto donde cada propiedad es como la columna de la tabla</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token string">&quot;_id&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;$oid&quot;</span><span class="token operator">:</span><span class="token string">&quot;620a5b245908e57941d2954c&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">&quot;nombre&quot;</span><span class="token operator">:</span><span class="token string">&quot;rex&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;descripcion&quot;</span><span class="token operator">:</span><span class="token string">&quot;descripcion de rex&quot;</span><span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Explicacion como si fuera una BD relacional</p> <ul><li>En una colección se guarda un conjunto de objetos(documentos)</li> <li>Los objetos pueden tener las mismas propiedades o diferentes.</li> <li>En este caso será igual(recomendado) para mantener la consistencia.</li> <li>Colección = Tabla</li> <li>Al insertar un documento = Insertar una fila</li> <li>Documento = fila</li> <li>La Fila = Es un objeto</li></ul></div> <ol start="7"><li>Creamos un usuario</li></ol> <ul><li>Security – DataBase Access</li> <li>Creamos un usuario</li></ul> <div class="custom-block tip"><p class="custom-block-title">ejemplo</p> <p>Usuario: usuarioVeterinaria</p> <p>Contraseña: Thw7Mk9CpQXoEjvY</p></div> <ol start="8"><li>Configurar el acceso a la BD(Firewall)</li></ol> <ul><li>En Security – Acceso a la Red</li></ul> <ol start="9"><li>Conseguir una Uri
<ol><li>En Clusters/Base de datos  le das a Connect.</li> <li>Connect your app (Conectarnos por la aplicación).</li> <li>Copiamos el String connection  y la ponemos en una variable const con la interpolación (en un archivo js)</li> <li>En el string remplazamos:</li></ol></li></ol> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">/*
  &lt;usuarioNOMBREBD&gt; por un usuario que tenga acceso a la BD
   &lt;password&gt; por la contraseña del usuario
   &lt;dbname&gt; o myFirstDatabase por el nombre de la base de datos.
 */</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token string">&quot;usuarioVeterinaria&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> password <span class="token operator">=</span> <span class="token string">&quot;Thw7Mk9CpQXoEjvY&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nombreBD <span class="token operator">=</span> <span class="token string">&quot;veterinaria&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uri <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mongodb+srv://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>password<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">@mascota.xcibc.mongodb.net/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nombreBD<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?retryWrites=true&amp;w=majority</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre></div><h2 id="mongoose"><a href="#mongoose" class="header-anchor">#</a> Mongoose</h2> <ul><li>Es una forma sencilla de establecer conexión con MongoDB.</li> <li>Se instala en node.js</li> <li><a href="https://mongoosejs.com/docs/index.html" target="_blank" rel="noopener noreferrer">info<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>Lo instalamos en el proyecto:</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>npm install mongoose
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Para conectarnos a una BD</p> <p>Necesitamos:</p> <ul><li>Un usuario</li> <li>Una contraseña</li> <li>Una uri  = Una url para establecer la conexion</li></ul></div> <p>Nos conectamos a la BD creada con la Uri:</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>La uri la genera MongoDB , hay que buscarla en la configuración</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.js</span>
<span class="token comment">// Conexion a BD</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token string">&quot;usuarioVeterinaria&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> password <span class="token operator">=</span> <span class="token string">&quot;Thw7Mk9CpQXoEjvY&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nombreBD <span class="token operator">=</span> <span class="token string">&quot;veterinaria&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uri <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mongodb+srv://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>password<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">@mascota.xcibc.mongodb.net/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nombreBD<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?retryWrites=true&amp;w=majority</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Base de datos conectada&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">seguridad</p> <p>Usamos variable de entorno  para ocultar la contraseña y el usuario.</p></div> <h2 id="schema"><a href="#schema" class="header-anchor">#</a> Schema</h2> <ul><li><p>Se debe crear un modelo(esquema) por cada colección(tabla) para poder especificar el nombre de cada propiedad y su tipo de valor(tipo de dato) para cada objeto.</p></li> <li><p>Es para especificar la estructura de la colección para luego poder manipular los objetos que contiene la colección.</p></li></ul> <ol><li>En el proyecto generamos una carpeta llamada models</li> <li>En dicha carpetamos , creamos mascota.js donde va a contener el esquema.</li></ol> <ul><li>Se hace un esquema (por lo tanto, un nuevo archivo.js) por cada colección.</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// models/mascota.js</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span>    <span class="token punctuation">{</span> Schema <span class="token punctuation">}</span> <span class="token operator">=</span> mongoose<span class="token punctuation">;</span>
<span class="token comment">// Definiendo el esquema:</span>
<span class="token keyword">const</span> mascotaSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

    <span class="token comment">// nombre de propiedad : tipo de valor ,  nombre de propiedad : tipo de valor</span>
    <span class="token comment">// Como la ID se genera sola, no se especifica</span>
    nombre<span class="token operator">:</span> String <span class="token punctuation">,</span>
    descripcion<span class="token operator">:</span> String
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// Creamos el esquema/modelo de mascota </span>
<span class="token comment">// model(nombre esquema , esquema)</span>
<span class="token keyword">const</span> Mascota <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Mascota'</span> <span class="token punctuation">,</span>mascotaSchema <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Exportamos el esquema/modelo</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Mascota<span class="token punctuation">;</span>

</code></pre></div><ol start="3"><li>En la carpeta router/Mascota.js</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// router/Mascota.js</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// Importamos el esquema</span>
 <span class="token keyword">const</span> Mascota <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/mascota'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="find"><a href="#find" class="header-anchor">#</a> find()</h2> <ul><li>Sirve para leer una colección que contiene varios documentos.</li> <li>Trae los documentos de una colección.</li> <li>La función la implementa un modelo.</li> <li>Al trabajar con una BD, utilizamos funciones async await para implementarla.</li> <li><a href="https://mongoosejs.com/docs/api.html#model_Model.find" target="_blank" rel="noopener noreferrer">mas info<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="custom-block tip"><p class="custom-block-title">Equivalencia a BD relacionales</p> <ul><li>Es como hacer un Select * from tabla</li> <li>Donde la tabla es la colección</li> <li>Y los resultados(filas) que genera la consulta , los guarda en un array.</li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// router/Mascota.js</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// Importamos el esquema</span>
 <span class="token keyword">const</span> Mascota <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/mascota'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Busca la coleccion de mascota y nos devuelve todos sus documentos.</span>
        <span class="token keyword">const</span> arrayMascotasBD <span class="token operator">=</span>  <span class="token keyword">await</span> Mascota<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrayMascotasBD<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// listaMascotas = Array</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">&quot;mascotas&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> listaMascotas<span class="token operator">:</span> arrayMascotasBD<span class="token punctuation">}</span>

     <span class="token punctuation">)</span>
    <span class="token punctuation">}</span> 
    <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    

   
<span class="token punctuation">}</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><h2 id="varibles-de-entorno"><a href="#varibles-de-entorno" class="header-anchor">#</a> Varibles de entorno</h2> <ul><li>Son para ocultar información sensible.</li> <li>Se configuran en el servidor.</li> <li><a href="https://www.npmjs.com/package/dotenv" target="_blank" rel="noopener noreferrer">Utilizamos este modulo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code>npm install dotenv
</code></pre></div><h3 id="configuracion"><a href="#configuracion" class="header-anchor">#</a> Configuracion</h3> <ol><li>Importalo</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dotenv'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>Crear archivo .env</li></ol> <ul><li>Si se desea cambiar el  nombre del archivo, se deberá configurar el path (ver documentacion)</li> <li>En este archivo van las variables de entorno</li> <li>Le podés asignar un valor (PORT = 3001) o dejar que el hosting le asigne un valor (USUARIO = xxx)</li></ul> <div class="language-env extra-class"><pre class="language-text"><code>PORT=3001
USUARIO=xxx
PASSWORD=xxx
DBNAME=xxx

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Las variables de entorno se generan y configuran en el hosting</p></div> <ol start="3"><li>Para acceder a una variable de entorno:</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NOMBREVARIABLE</span>
</code></pre></div><p>Ejemplo: En un entorno local</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dotenv'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">3000</span>

</code></pre></div><div class="language-env extra-class"><pre class="language-text"><code>PORT=3001
</code></pre></div><p>Otro Ejemplo:</p> <div class="language-env extra-class"><pre class="language-text"><code>PORT=3001
USER=usuarioVeterinaria
PASSWORD=Thw7Mk9CpQXoEjvY
BD=veterinaria
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//index.js</span>
<span class="token comment">// Conexion a BD</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uri <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mongodb+srv://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">USER</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PASSWORD</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">@mascota.xcibc.mongodb.net/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">BD</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?retryWrites=true&amp;w=majority</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span>

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li>Todos esos Ejemplos tienen las variables de entorno en un entorno local (están ubicada en nuestra PC).</li> <li>el archivo .env se debe ignorar junto con el node_modules en git.</li></ul></div> <p>Ejemplo en un entorno de producción (subido a un hosting):</p> <ol><li>Se crean las variables (como si fuera un .env) en el hosting (Configurar el hosting)</li> <li>el index.js sigue igual , no se modifica</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.js</span>
<span class="token comment">// Conexion a BD</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uri <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mongodb+srv://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">USER</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PASSWORD</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">@mascota.xcibc.mongodb.net/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">BD</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?retryWrites=true&amp;w=majority</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span>

</code></pre></div><ol start="3"><li>Se sube el proyecto al hosting ignorando el archivo.env</li></ol> <h2 id="bodyparser"><a href="#bodyparser" class="header-anchor">#</a> bodyParser</h2> <ul><li>Lo Tenemos que instalar para utilizar x-www-form-urlencoded</li> <li>Sirve para leer el formulario (Leer el cuerpo del body)</li> <li><a href="https://www.npmjs.com/package/body-parser" target="_blank" rel="noopener noreferrer">modulo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <ol><li>Lo instalamos:</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>npm i body<span class="token operator">-</span>parser
</code></pre></div><ol start="2"><li>Lo configuramos</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Importamos bodyParser</span>
<span class="token keyword">const</span>  bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Lo configuramos</span>
<span class="token comment">// parse application/x-www-form-urlencoded</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// parse application/json</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dotenv'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">3000</span>

</code></pre></div><h2 id="crear"><a href="#crear" class="header-anchor">#</a> Crear</h2> <ol><li>Creamos el archivo crear.ejs en la carpeta de vistas</li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Los name de los inputs deben coincidir con el nombre de las propiedades del documento(objeto) a crear(MONGODB)</li> <li>Para ver si coincidi eso , busca en el esquema</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mascotaSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

    <span class="token comment">// nombre de propiedad : tipo de valor ,  nombre de propiedad : tipo de valor</span>
    <span class="token comment">// Como la ID se genera sola, no se especifica</span>
    nombre<span class="token operator">:</span> String <span class="token punctuation">,</span>
    descripcion<span class="token operator">:</span> String
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>Como se puede ver en el esquema hay dos propiedades , nombre y descripción.</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/cabecera&quot;</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>title <span class="token operator">:</span> <span class="token string">&quot;Crear nuevo mascota&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>   <span class="token operator">%</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Crear<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">&quot;/mascotas&quot;</span> method<span class="token operator">=</span><span class="token string">&quot;POST&quot;</span><span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>input
           type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
           placeholder<span class="token operator">=</span><span class="token string">&quot;Agregar nombre&quot;</span>
           <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form-control my-2&quot;</span>
           name<span class="token operator">=</span><span class="token string">&quot;nombre&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input
           type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
           placeholder<span class="token operator">=</span><span class="token string">&quot;Agregar descripcion&quot;</span>
           <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form-control my-2&quot;</span> 
           name<span class="token operator">=</span><span class="token string">&quot;descripcion&quot;</span><span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;d-grid gap-2&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-success&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span><span class="token operator">&gt;</span>Agregar<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
          
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/footer&quot;</span><span class="token punctuation">)</span>    <span class="token operator">%</span><span class="token operator">&gt;</span>

</code></pre></div><ol start="2"><li>mascotas.ejs</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> views<span class="token operator">/</span>mascotas<span class="token punctuation">.</span>ejs <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/cabecera&quot;</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>title<span class="token operator">:</span> <span class="token string">&quot;titulo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token operator">%</span><span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Crud Mongo<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;d-grid gap-2&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-success  my4&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;mascotas/crear&quot;</span><span class="token operator">&gt;</span>Crear nueva mascota<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>table <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>thead<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>#<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Nombre<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Descripcion<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Accion<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>thead<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>tbody<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>listaMascotas<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
              
                <span class="token operator">&lt;</span><span class="token operator">%</span> listaMascotas<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">mascota</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;row&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>id  <span class="token operator">%</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>nombre  <span class="token operator">%</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>descripcion  <span class="token operator">%</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>@mdo<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span> 
        
            <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
       
          
        <span class="token operator">&lt;</span><span class="token operator">/</span>tbody<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">&gt;</span>
   
   
 <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/footer&quot;</span><span class="token punctuation">)</span>    <span class="token operator">%</span><span class="token operator">&gt;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Ahora vamos a trabajar con el verbo POST</li> <li>Nos permite recibir información</li></ul></div> <p>router/Mascota.js</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>La información se recibe por el body del requerimiento.</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Mascota.js </span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/crear&quot;</span> <span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'crear'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span> <span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><h3 id="guardar-insertar-documento-metodo-1"><a href="#guardar-insertar-documento-metodo-1" class="header-anchor">#</a> Guardar/insertar documento - metodo 1:</h3> <ul><li><a href="https://mongoosejs.com/docs/models.html" target="_blank" rel="noopener noreferrer">info<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Se crea utilizando el esquema</p></div> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> Mascota <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/mascota'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span> <span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Creamos el documento/objeto</span>
        <span class="token comment">// const variable = new nombreesquema(objeto/documento)</span>
       <span class="token keyword">const</span> mascotaDB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mascota</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// Lo guardamos en la base de datos</span>
       <span class="token keyword">await</span> mascotaDB<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>usamos redirect(“ruta”) para direccionar a otra ruta.</p></div> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span> <span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Creamos el documento/objeto</span>
        <span class="token comment">// const variable = new nombreesquema(objeto/documento)</span>
       <span class="token keyword">const</span> mascotaDB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mascota</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// Lo guardamos en la base de datos</span>
       <span class="token keyword">await</span> mascotaDB<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&quot;/mascotas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="guardar-insertar-documento-metodo-2"><a href="#guardar-insertar-documento-metodo-2" class="header-anchor">#</a> Guardar/insertar documento - metodo 2:</h3> <ul><li>Se crea utilizando el esquema:</li> <li>Se crea y se guarda en la misma línea.</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span> <span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// Lo creamos y lo guardamos</span>

        <span class="token comment">// Creamos el documento/objeto en MongoDB</span>
        <span class="token comment">// create(objeto/documento)</span>
     <span class="token keyword">await</span> Mascota<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span>
      
       res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&quot;/mascotas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="get-unico-documento"><a href="#get-unico-documento" class="header-anchor">#</a> Get único documento</h2> <p>router/Mascota.js</p> <ul><li>Utilizamos una url dinámica</li> <li>Impleméntamos en la ruta  &quot; :nombrevariable  &quot;</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//  &quot;/:nombrevariable&quot;</span>
<span class="token comment">//la ruta es /mascotas/valordelnombrevariable</span>
<span class="token comment">// Ejemplo: http://localhost:3001/mascotas/620a5b245908e57941d2954c</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:id'</span> <span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
       <span class="token comment">// req.params.nombrevariable para obtener el valor de dicha variable</span>
       <span class="token keyword">const</span> id <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
       <span class="token comment">// Buscamos la primera mascota que _id sea igual a la const id.</span>
       <span class="token keyword">const</span> mascotaDB <span class="token operator">=</span> <span class="token keyword">await</span> Mascota<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id <span class="token operator">:</span> id<span class="token punctuation">}</span><span class="token punctuation">)</span>
       res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'detalle'</span> <span class="token punctuation">,</span>  <span class="token punctuation">{</span>mascota<span class="token operator">:</span> mascotaDB <span class="token punctuation">,</span> error<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'detalle'</span> <span class="token punctuation">,</span>  <span class="token punctuation">{</span>error<span class="token operator">:</span><span class="token boolean">true</span> <span class="token punctuation">,</span> mensaje<span class="token operator">:</span> <span class="token string">&quot;No se encuentra el id seleccionado&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><p>views/detalle.ejs</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/cabecera&quot;</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>title <span class="token operator">:</span> <span class="token string">&quot;Detalle de mascota&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Detalle Mascota<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">%=</span> mensaje <span class="token operator">%</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;d-grid gap-2&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/mascotas&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-dark &quot;</span><span class="token operator">&gt;</span>Volver a Mascotas<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>table <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>thead<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>#<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Nombre<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Descripcion<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Accion<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>thead<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>tbody<span class="token operator">&gt;</span>


                            <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;row&quot;</span><span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>id <span class="token operator">%</span><span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>nombre <span class="token operator">%</span><span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>descripcion <span class="token operator">%</span><span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>@mdo<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>




                        <span class="token operator">&lt;</span><span class="token operator">/</span>tbody<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">&gt;</span>

                    <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/footer&quot;</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span>

</code></pre></div><p>views/mascotas.ejs</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> views<span class="token operator">/</span>mascotas<span class="token punctuation">.</span>ejs <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/cabecera&quot;</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>title<span class="token operator">:</span> <span class="token string">&quot;titulo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token operator">%</span><span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Crud Mongo<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;d-grid gap-2&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-success  my4&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;mascotas/crear&quot;</span><span class="token operator">&gt;</span>Crear nueva mascota<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>table <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>thead<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>#<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Nombre<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Descripcion<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Accion<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>thead<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>tbody<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>listaMascotas<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
              
                <span class="token operator">&lt;</span><span class="token operator">%</span> listaMascotas<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">mascota</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;row&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>id  <span class="token operator">%</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>nombre  <span class="token operator">%</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>descripcion  <span class="token operator">%</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;mascotas/&lt;%= mascota.id  %&gt;&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-warning btn-sm&quot;</span><span class="token operator">&gt;</span>Editar<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span> 
        
            <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
       
          
        <span class="token operator">&lt;</span><span class="token operator">/</span>tbody<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">&gt;</span>
   
   
 <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/footer&quot;</span><span class="token punctuation">)</span>    <span class="token operator">%</span><span class="token operator">&gt;</span>

</code></pre></div><h2 id="delete-documento"><a href="#delete-documento" class="header-anchor">#</a> Delete documento</h2> <ul><li>Vamos a usar el verbo http Delete para eliminar.</li> <li>Una petición delete se crea por el método fetch ya que el formulario HTML no lo envia.</li> <li>Vamos a hacer una respuesta en json</li></ul> <p>router/Mascota.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// mascotas/valordelavariableid</span>
router<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/:id'</span> <span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req <span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>  <span class="token punctuation">{</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Buscamos la mascota por la _id y lo eliminamos</span>
          <span class="token comment">// Si se elimina correctamente devuelve el documento que se borro</span>
        <span class="token keyword">const</span> mascotaDB <span class="token operator">=</span> <span class="token keyword">await</span> Mascota<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id <span class="token operator">:</span> id<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mascotaDB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token comment">// respuesta en json </span>
               res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> estado <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">,</span> mensaje<span class="token operator">:</span> <span class="token string">&quot;eliminado!&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
              <span class="token comment">// respuesta en json</span>
              res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>estado<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">,</span>mensaje<span class="token operator">:</span> <span class="token string">&quot;fallo al eliminar!&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><p>views/detalle.ejs</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/cabecera&quot;</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>title <span class="token operator">:</span> <span class="token string">&quot;Detalle de mascota&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Detalle Mascota<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">%=</span> mensaje <span class="token operator">%</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;d-grid gap-2&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/mascotas&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-dark &quot;</span><span class="token operator">&gt;</span>Volver a Mascotas<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>table <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>thead<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>#<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Nombre<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Descripcion<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;col&quot;</span><span class="token operator">&gt;</span>Accion<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>thead<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>tbody<span class="token operator">&gt;</span>


                            <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>th scope<span class="token operator">=</span><span class="token string">&quot;row&quot;</span><span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>id <span class="token operator">%</span><span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>nombre <span class="token operator">%</span><span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token operator">%=</span> mascota<span class="token punctuation">.</span>descripcion <span class="token operator">%</span><span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>button  id<span class="token operator">=</span><span class="token string">&quot;btnEliminar&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-danger btn-sm&quot;</span> data<span class="token operator">-</span>id<span class="token operator">=</span><span class="token string">&quot;&lt;%= mascota.id %&gt;&quot;</span><span class="token operator">&gt;</span>Eliminar<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>




                        <span class="token operator">&lt;</span><span class="token operator">/</span>tbody<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">&gt;</span>

                    <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/footer&quot;</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
      <span class="token keyword">const</span> btnEliminar <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;btnEliminar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     btnEliminar<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
         <span class="token keyword">const</span> id <span class="token operator">=</span> btnEliminar<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
         <span class="token keyword">try</span> <span class="token punctuation">{</span>
             <span class="token comment">// Enviamos una solicitud delete por fetch (Si no especificamos que es delete se hace get)</span>
             <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/mascotas/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>method<span class="token operator">:</span> <span class="token string">'delete'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>estado<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//  Rediccionamos</span>
                 window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&quot;/mascotas&quot;</span>
             <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

</code></pre></div><h2 id="editar-documento"><a href="#editar-documento" class="header-anchor">#</a> Editar documento</h2> <ul><li>Utilizamos el metodo http put que generalmente se usa para modificar.</li> <li>Vamos a utilizar el body del requirimiento por lo tanto hacer los arreglos necesarios (ver el apartado de bodyparser)</li> <li>El form (HTML) solo soporta GET Y POST . Por lo tanto para usar put vamos a usar javascript(fetch) , igual que como Delete.</li></ul> <p>router/Mascota.js</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/:id'</span> <span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token keyword">const</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// Encontrar la mascota y modificarla</span>
        <span class="token comment">// Parametros findByIdAndUpdate(id a buscar , los datos nuevos , una opcion para evitar un warning)</span>
         <span class="token comment">// devuelve el documento modificado</span>
       <span class="token keyword">const</span> mascotaBD <span class="token operator">=</span> <span class="token keyword">await</span> Mascota<span class="token punctuation">.</span><span class="token function">findByIdAndUpdate</span><span class="token punctuation">(</span>id <span class="token punctuation">,</span> body <span class="token punctuation">,</span> <span class="token punctuation">{</span>useFindAndModify<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
       res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>estado<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">,</span> mensaje<span class="token operator">:</span><span class="token string">&quot;Editado&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>estado<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">,</span> mensaje<span class="token operator">:</span><span class="token string">&quot;Fallamos&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>Como es para manipular una BD usamos una función async await</li> <li>Para leer el body tmb debe estar configurado el bodyParser para JSON</li></ul></div> <p>detalle.ejs</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/cabecera&quot;</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>title <span class="token operator">:</span> <span class="token string">&quot;Detalle de mascota&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Detalle Mascota<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">%=</span> mensaje <span class="token operator">%</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;d-grid gap-2&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/mascotas&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-dark &quot;</span><span class="token operator">&gt;</span>Volver a Mascotas<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">&quot;&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;formEditar&quot;</span> data<span class="token operator">-</span>id<span class="token operator">=</span><span class="token string">&quot;&lt;%= mascota.id %&gt;&quot;</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>input
                        type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
                        placeholder<span class="token operator">=</span><span class="token string">&quot;Agregar nombre&quot;</span>
                        <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form-control my-2&quot;</span>
                        name<span class="token operator">=</span><span class="token string">&quot;nombre&quot;</span> 
                        value <span class="token operator">=</span> <span class="token string">&quot; &lt;%= mascota.nombre %&gt;&quot;</span>
                        id<span class="token operator">=</span><span class="token string">&quot;nombreInput&quot;</span><span class="token operator">&gt;</span>
                         <span class="token operator">&lt;</span>input
                        type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
                        placeholder<span class="token operator">=</span><span class="token string">&quot;Agregar descripcion&quot;</span>
                        <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form-control my-2&quot;</span> 
                        name<span class="token operator">=</span><span class="token string">&quot;descripcion&quot;</span>
                        value <span class="token operator">=</span> <span class="token string">&quot; &lt;%= mascota.descripcion %&gt;&quot;</span>
                        id<span class="token operator">=</span><span class="token string">&quot;descripcionInput&quot;</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;d-grid gap-2&quot;</span><span class="token operator">&gt;</span>
                         <span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-warning&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span> <span class="token operator">&gt;</span>Editar<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button  id<span class="token operator">=</span><span class="token string">&quot;btnEliminar&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-danger btn-sm mt-5&quot;</span> data<span class="token operator">-</span>id<span class="token operator">=</span><span class="token string">&quot;&lt;%= mascota.id %&gt;&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span><span class="token operator">&gt;</span>Eliminar<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                   

                    <span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
  
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token function">include</span><span class="token punctuation">(</span><span class="token string">&quot;template/footer&quot;</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
      <span class="token keyword">const</span> btnEliminar <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;btnEliminar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     btnEliminar<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
         <span class="token keyword">const</span> id <span class="token operator">=</span> btnEliminar<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
         <span class="token keyword">try</span> <span class="token punctuation">{</span>
             <span class="token comment">// Enviamos una solicitud delete por fetch (Si no especificamos que es delete se hace get)</span>
             <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/mascotas/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>method<span class="token operator">:</span> <span class="token string">'delete'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>estado<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//  Rediccionamos</span>
                 window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&quot;/mascotas&quot;</span>
             <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token keyword">const</span> formularioEditar <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;formEditar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     formularioEditar<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'submit'</span> <span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
         e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// Seleccionamos el input que contiene el nombre a traves de su atributo name</span>
         <span class="token comment">//elements['valordelatributoname']</span>
         <span class="token keyword">const</span> nombre <span class="token operator">=</span> formularioEditar<span class="token punctuation">.</span>elements<span class="token punctuation">[</span><span class="token string">'nombre'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
         <span class="token keyword">const</span> descripcion <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#descripcionInput'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
         <span class="token keyword">const</span> id <span class="token operator">=</span> formularioEditar<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>nombre <span class="token punctuation">,</span> descripcion <span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">try</span> <span class="token punctuation">{</span>
             <span class="token comment">// En el fetch enviamos informacion(JSON) a traves del body</span>
            <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/mascotas/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>method<span class="token operator">:</span> <span class="token string">'put'</span> <span class="token punctuation">,</span> 
                headers<span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token comment">//Le indicamos que vamos a mandar un JSON</span>
                    <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span>
                <span class="token punctuation">}</span> <span class="token punctuation">,</span> 
                body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token comment">//Enviamos un JSON a traves del body</span>
                <span class="token comment">// nombre = const nombre </span>
                <span class="token comment">//descripcion = const descripcion</span>
                <span class="token comment">// Si la propiedad y el valor tienen el mismo nombre, no hace falta especificar el valor</span>
                nombre <span class="token punctuation">,</span> descripcion
            <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>estado<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                 <span class="token comment">//  Rediccionamos</span>
                 window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&quot;/mascotas&quot;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span> 
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/aprendizaje/Node/router.html" class="prev">
        Router
      </a></span> <span class="next"><a href="/aprendizaje/Node/token.html">
        Token y Practica API REST
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/aprendizaje/assets/js/app.c8ef5d59.js" defer></script><script src="/aprendizaje/assets/js/2.c431ec36.js" defer></script><script src="/aprendizaje/assets/js/45.9c247c80.js" defer></script>
  </body>
</html>
